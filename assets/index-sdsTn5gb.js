var Oe=Object.defineProperty;var qe=(o,t,e)=>t in o?Oe(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var f=(o,t,e)=>qe(o,typeof t!="symbol"?t+"":t,e);import{r as Fe,a as We,b as y,u as ze,L as it,d as Bt,N as ue,e as Ve,f as Qe,R as Ie,h as ft,i as Ne,B as Ue}from"./vendor-C5KOkYOE.js";import{D as He}from"./database-CJKZqENN.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();var ee={exports:{}},St={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var he;function Ge(){if(he)return St;he=1;var o=Fe(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function n(c,l,d){var h,w={},g=null,b=null;d!==void 0&&(g=""+d),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(b=l.ref);for(h in l)i.call(l,h)&&!s.hasOwnProperty(h)&&(w[h]=l[h]);if(c&&c.defaultProps)for(h in l=c.defaultProps,l)w[h]===void 0&&(w[h]=l[h]);return{$$typeof:t,type:c,key:g,ref:b,props:w,_owner:r.current}}return St.Fragment=e,St.jsx=n,St.jsxs=n,St}var me;function Xe(){return me||(me=1,ee.exports=Ge()),ee.exports}var a=Xe(),Wt={},ye;function Ye(){if(ye)return Wt;ye=1;var o=We();return Wt.createRoot=o.createRoot,Wt.hydrateRoot=o.hydrateRoot,Wt}var Je=Ye();const Tt=class Tt extends He{constructor(){super(Tt.DATABASE_NAME);f(this,"trips");f(this,"participants");f(this,"products");f(this,"consumptions");f(this,"availabilities");this.version(Tt.CURRENT_VERSION).stores({trips:"id, name, startDate, endDate, createdAt",participants:"id, tripId, name, createdAt",products:"id, name, category, type, createdAt",consumptions:"id, tripId, participantId, productId, date, meal, [tripId+date], [tripId+participantId], [tripId+productId]",availabilities:"id, participantId, tripId, date, [tripId+date], [participantId+date], [participantId+tripId]"})}async clearAllData(){await this.transaction("rw",[this.trips,this.participants,this.products,this.consumptions,this.availabilities],async()=>{await Promise.all([this.trips.clear(),this.participants.clear(),this.products.clear(),this.consumptions.clear(),this.availabilities.clear()])})}async healthCheck(){try{return await this.trips.count(),!0}catch{return!1}}};f(Tt,"DATABASE_NAME","tripfood-db"),f(Tt,"CURRENT_VERSION",1);let Vt=Tt;new Vt;class mt{constructor(){}static toRecord(t){return{id:t.id,name:t.name,description:t.description,startDate:t.startDate.toISOString(),endDate:t.endDate.toISOString(),createdAt:t.createdAt.toISOString(),updatedAt:t.updatedAt.toISOString()}}static toDomainProps(t){return{id:t.id,name:t.name,description:t.description,startDate:new Date(t.startDate),endDate:new Date(t.endDate),createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)}}static toDomainPropsList(t){return t.map(e=>mt.toDomainProps(e))}static toRecordList(t){return t.map(e=>mt.toRecord(e))}static toPartialRecord(t){const e={updatedAt:new Date().toISOString()};return t.name!==void 0&&(e.name=t.name),t.description!==void 0&&(e.description=t.description),t.startDate!==void 0&&(e.startDate=t.startDate.toISOString()),t.endDate!==void 0&&(e.endDate=t.endDate.toISOString()),e}}class Qt extends Error{constructor(e,i){super(e);f(this,"name","InfrastructureError");f(this,"originalError");f(this,"timestamp");this.originalError=i,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,Qt),i!=null&&i.stack&&(this.stack=`${this.stack}

Caused by: ${i.stack}`)}toJSON(){return{name:this.name,message:this.message,timestamp:this.timestamp.toISOString(),originalError:this.originalError?{name:this.originalError.name,message:this.originalError.message}:void 0,stack:this.stack}}static isInfrastructureError(e){return e instanceof Qt}}class m extends Qt{constructor(e,i,r,s){const n=m.buildMessage(e,i,s);super(n,r);f(this,"name","DatabaseError");f(this,"operation");f(this,"tableName");f(this,"recordId");this.operation=e,this.tableName=i,this.recordId=s,Error.captureStackTrace&&Error.captureStackTrace(this,m)}static buildMessage(e,i,r){const s=`Database operation '${e}' failed on table '${i}'`;return r?`${s} for record '${r}'`:s}toJSON(){return{...super.toJSON(),operation:this.operation,tableName:this.tableName,recordId:this.recordId}}static isDatabaseError(e){return e instanceof m}static connectionError(e){return new m("connection","database",e)}static migrationError(e){return new m("migration","database",e)}}class Ke{constructor(t,e){f(this,"db");f(this,"tripFactory");this.db=t,this.tripFactory=e}async findById(t){try{const e=await this.db.trips.get(t);if(!e)return null;const i=mt.toDomainProps(e);return this.tripFactory(i)}catch(e){throw new m("findById","trips",e instanceof Error?e:void 0,t)}}async findAll(){try{const t=await this.db.trips.toArray();return mt.toDomainPropsList(t).map(i=>this.tripFactory(i))}catch(t){throw new m("findAll","trips",t instanceof Error?t:void 0)}}async save(t){try{const e=mt.toRecord(t);return await this.db.trips.put(e),t}catch(e){throw new m("create","trips",e instanceof Error?e:void 0,t.id)}}async delete(t){try{await this.db.trips.delete(t)}catch(e){throw new m("delete","trips",e instanceof Error?e:void 0,t)}}async findByName(t){try{const e=t.toLowerCase(),i=await this.db.trips.filter(s=>s.name.toLowerCase().includes(e)).toArray();return mt.toDomainPropsList(i).map(s=>this.tripFactory(s))}catch(e){throw new m("find","trips",e instanceof Error?e:void 0)}}async findByDate(t){try{const e=t.toISOString(),i=await this.db.trips.filter(s=>s.startDate<=e&&s.endDate>=e).toArray();return mt.toDomainPropsList(i).map(s=>this.tripFactory(s))}catch(e){throw new m("find","trips",e instanceof Error?e:void 0)}}async findByDateRange(t,e){try{const i=t.toISOString(),r=e.toISOString(),s=await this.db.trips.filter(c=>c.startDate<=r&&c.endDate>=i).toArray();return mt.toDomainPropsList(s).map(c=>this.tripFactory(c))}catch(i){throw new m("find","trips",i instanceof Error?i:void 0)}}async findAllOrderedByStartDate(){try{const t=await this.db.trips.orderBy("startDate").reverse().toArray();return mt.toDomainPropsList(t).map(i=>this.tripFactory(i))}catch(t){throw new m("findAll","trips",t instanceof Error?t:void 0)}}async count(){try{return await this.db.trips.count()}catch(t){throw new m("count","trips",t instanceof Error?t:void 0)}}async exists(t){try{return await this.db.trips.where("id").equals(t).count()>0}catch(e){throw new m("find","trips",e instanceof Error?e:void 0,t)}}async update(t,e){try{const i=await this.db.trips.get(t);if(!i)return null;const r={...i,...e,updatedAt:new Date().toISOString()};await this.db.trips.put(r);const s=mt.toDomainProps(r);return this.tripFactory(s)}catch(i){throw new m("update","trips",i instanceof Error?i:void 0,t)}}async deleteMany(t){try{await this.db.trips.bulkDelete(t)}catch(e){throw new m("delete","trips",e instanceof Error?e:void 0)}}}class dt{constructor(){}static toRecord(t){return{id:t.id,tripId:t.tripId,name:t.name,email:t.email,notes:t.notes,createdAt:t.createdAt.toISOString()}}static toDomainProps(t){return{id:t.id,tripId:t.tripId,name:t.name,email:t.email,notes:t.notes,createdAt:new Date(t.createdAt)}}static toDomainPropsList(t){return t.map(e=>dt.toDomainProps(e))}static toRecordList(t){return t.map(e=>dt.toRecord(e))}static toPartialRecord(t){const e={};return t.name!==void 0&&(e.name=t.name),t.email!==void 0&&(e.email=t.email),t.notes!==void 0&&(e.notes=t.notes),e}}class Ze{constructor(t,e){f(this,"db");f(this,"participantFactory");this.db=t,this.participantFactory=e}async findById(t){try{const e=await this.db.participants.get(t);if(!e)return null;const i=dt.toDomainProps(e);return this.participantFactory(i)}catch(e){throw new m("findById","participants",e instanceof Error?e:void 0,t)}}async findAll(){try{const t=await this.db.participants.toArray();return dt.toDomainPropsList(t).map(i=>this.participantFactory(i))}catch(t){throw new m("findAll","participants",t instanceof Error?t:void 0)}}async save(t){try{const e=dt.toRecord(t);return await this.db.participants.put(e),t}catch(e){throw new m("create","participants",e instanceof Error?e:void 0,t.id)}}async delete(t){try{await this.db.participants.delete(t)}catch(e){throw new m("delete","participants",e instanceof Error?e:void 0,t)}}async findByTripId(t){try{const e=await this.db.participants.where("tripId").equals(t).toArray();return dt.toDomainPropsList(e).map(r=>this.participantFactory(r))}catch(e){throw new m("findByIndex","participants",e instanceof Error?e:void 0,t)}}async findByName(t){try{const e=t.toLowerCase(),i=await this.db.participants.filter(s=>s.name.toLowerCase().includes(e)).toArray();return dt.toDomainPropsList(i).map(s=>this.participantFactory(s))}catch(e){throw new m("find","participants",e instanceof Error?e:void 0)}}async findByTripIdAndName(t,e){try{const i=await this.db.participants.where("tripId").equals(t).filter(s=>s.name.toLowerCase()===e.toLowerCase()).first();if(!i)return null;const r=dt.toDomainProps(i);return this.participantFactory(r)}catch(i){throw new m("find","participants",i instanceof Error?i:void 0)}}async findByEmail(t){try{const e=t.toLowerCase(),i=await this.db.participants.filter(s=>s.email?s.email.toLowerCase().includes(e):!1).toArray();return dt.toDomainPropsList(i).map(s=>this.participantFactory(s))}catch(e){throw new m("find","participants",e instanceof Error?e:void 0)}}async countByTripId(t){try{return await this.db.participants.where("tripId").equals(t).count()}catch(e){throw new m("count","participants",e instanceof Error?e:void 0)}}async exists(t){try{return await this.db.participants.where("id").equals(t).count()>0}catch(e){throw new m("find","participants",e instanceof Error?e:void 0,t)}}async update(t,e){try{const i=await this.db.participants.get(t);if(!i)return null;const r={...i,...e};await this.db.participants.put(r);const s=dt.toDomainProps(r);return this.participantFactory(s)}catch(i){throw new m("update","participants",i instanceof Error?i:void 0,t)}}async deleteByTripId(t){try{return await this.db.participants.where("tripId").equals(t).delete()}catch(e){throw new m("delete","participants",e instanceof Error?e:void 0,t)}}async deleteMany(t){try{await this.db.participants.bulkDelete(t)}catch(e){throw new m("delete","participants",e instanceof Error?e:void 0)}}async saveMany(t){try{const e=dt.toRecordList(t);return await this.db.participants.bulkPut(e),t}catch(e){throw new m("create","participants",e instanceof Error?e:void 0)}}async count(){try{return await this.db.participants.count()}catch(t){throw new m("count","participants",t instanceof Error?t:void 0)}}}class Z{constructor(){}static isValidProductType(t){return t==="food"||t==="beverage"}static toRecord(t){return{id:t.id,name:t.name,category:t.category,type:t.type,unit:t.unit,defaultQuantityPerPerson:t.defaultQuantityPerPerson,notes:t.notes,createdAt:t.createdAt.toISOString()}}static toDomainProps(t){if(!Z.isValidProductType(t.type))throw new Error(`Invalid product type: ${t.type}. Expected 'food' or 'beverage'.`);return{id:t.id,name:t.name,category:t.category,type:t.type,unit:t.unit,defaultQuantityPerPerson:t.defaultQuantityPerPerson,notes:t.notes,createdAt:new Date(t.createdAt)}}static toDomainPropsList(t){return t.map(e=>Z.toDomainProps(e))}static toRecordList(t){return t.map(e=>Z.toRecord(e))}static toPartialRecord(t){const e={};return t.name!==void 0&&(e.name=t.name),t.category!==void 0&&(e.category=t.category),t.type!==void 0&&(e.type=t.type),t.unit!==void 0&&(e.unit=t.unit),t.defaultQuantityPerPerson!==void 0&&(e.defaultQuantityPerPerson=t.defaultQuantityPerPerson),t.notes!==void 0&&(e.notes=t.notes),e}}class ta{constructor(t,e){f(this,"db");f(this,"productFactory");this.db=t,this.productFactory=e}async findById(t){try{const e=await this.db.products.get(t);if(!e)return null;const i=Z.toDomainProps(e);return this.productFactory(i)}catch(e){throw new m("findById","products",e instanceof Error?e:void 0,t)}}async findAll(){try{const t=await this.db.products.toArray();return Z.toDomainPropsList(t).map(i=>this.productFactory(i))}catch(t){throw new m("findAll","products",t instanceof Error?t:void 0)}}async save(t){try{const e=Z.toRecord(t);return await this.db.products.put(e),t}catch(e){throw new m("create","products",e instanceof Error?e:void 0,t.id)}}async delete(t){try{await this.db.products.delete(t)}catch(e){throw new m("delete","products",e instanceof Error?e:void 0,t)}}async findByCategory(t){try{const e=await this.db.products.where("category").equals(t).toArray();return Z.toDomainPropsList(e).map(r=>this.productFactory(r))}catch(e){throw new m("findByIndex","products",e instanceof Error?e:void 0)}}async findByType(t){try{const e=await this.db.products.where("type").equals(t).toArray();return Z.toDomainPropsList(e).map(r=>this.productFactory(r))}catch(e){throw new m("findByIndex","products",e instanceof Error?e:void 0)}}async findByName(t){try{const e=t.toLowerCase(),i=await this.db.products.filter(s=>s.name.toLowerCase().includes(e)).toArray();return Z.toDomainPropsList(i).map(s=>this.productFactory(s))}catch(e){throw new m("find","products",e instanceof Error?e:void 0)}}async findByExactName(t){try{const e=await this.db.products.filter(r=>r.name.toLowerCase()===t.toLowerCase()).first();if(!e)return null;const i=Z.toDomainProps(e);return this.productFactory(i)}catch(e){throw new m("find","products",e instanceof Error?e:void 0)}}async getDistinctCategories(){try{return await this.db.products.orderBy("category").uniqueKeys()}catch(t){throw new m("find","products",t instanceof Error?t:void 0)}}async exists(t){try{return await this.db.products.where("id").equals(t).count()>0}catch(e){throw new m("find","products",e instanceof Error?e:void 0,t)}}async update(t,e){try{const i=await this.db.products.get(t);if(!i)return null;const r={...i,...e};await this.db.products.put(r);const s=Z.toDomainProps(r);return this.productFactory(s)}catch(i){throw new m("update","products",i instanceof Error?i:void 0,t)}}async count(){try{return await this.db.products.count()}catch(t){throw new m("count","products",t instanceof Error?t:void 0)}}async countByCategory(t){try{return await this.db.products.where("category").equals(t).count()}catch(e){throw new m("count","products",e instanceof Error?e:void 0)}}async countByType(t){try{return await this.db.products.where("type").equals(t).count()}catch(e){throw new m("count","products",e instanceof Error?e:void 0)}}async deleteMany(t){try{await this.db.products.bulkDelete(t)}catch(e){throw new m("delete","products",e instanceof Error?e:void 0)}}async saveMany(t){try{const e=Z.toRecordList(t);return await this.db.products.bulkPut(e),t}catch(e){throw new m("create","products",e instanceof Error?e:void 0)}}async findAllOrderedByName(){try{const t=await this.db.products.orderBy("name").toArray();return Z.toDomainPropsList(t).map(i=>this.productFactory(i))}catch(t){throw new m("findAll","products",t instanceof Error?t:void 0)}}async findAllGroupedByCategory(){try{const t=await this.db.products.orderBy("category").toArray();return t.sort((i,r)=>i.category===r.category?i.name.localeCompare(r.name):i.category.localeCompare(r.category)),Z.toDomainPropsList(t).map(i=>this.productFactory(i))}catch(t){throw new m("findAll","products",t instanceof Error?t:void 0)}}}const bt=class bt{constructor(){}static isValidMealType(t){return bt.VALID_MEALS.includes(t)}static toRecord(t){return{id:t.id,tripId:t.tripId,participantId:t.participantId,productId:t.productId,date:t.date.toISOString(),meal:t.meal,quantity:t.quantity,createdAt:t.createdAt.toISOString()}}static toDomainProps(t){if(!bt.isValidMealType(t.meal))throw new Error(`Invalid meal type: ${t.meal}. Expected one of: ${bt.VALID_MEALS.join(", ")}.`);return{id:t.id,tripId:t.tripId,participantId:t.participantId,productId:t.productId,date:new Date(t.date),meal:t.meal,quantity:t.quantity,createdAt:new Date(t.createdAt)}}static toDomainPropsList(t){return t.map(e=>bt.toDomainProps(e))}static toRecordList(t){return t.map(e=>bt.toRecord(e))}static toPartialRecord(t){const e={};return t.participantId!==void 0&&(e.participantId=t.participantId),t.productId!==void 0&&(e.productId=t.productId),t.date!==void 0&&(e.date=t.date.toISOString()),t.meal!==void 0&&(e.meal=t.meal),t.quantity!==void 0&&(e.quantity=t.quantity),e}static toDateOnlyString(t){return t.toISOString().split("T")[0]??""}};f(bt,"VALID_MEALS",["breakfast","lunch","dinner","snack"]);let G=bt;class ea{constructor(t,e){f(this,"db");f(this,"consumptionFactory");this.db=t,this.consumptionFactory=e}async findById(t){try{const e=await this.db.consumptions.get(t);if(!e)return null;const i=G.toDomainProps(e);return this.consumptionFactory(i)}catch(e){throw new m("findById","consumptions",e instanceof Error?e:void 0,t)}}async findAll(){try{const t=await this.db.consumptions.toArray();return G.toDomainPropsList(t).map(i=>this.consumptionFactory(i))}catch(t){throw new m("findAll","consumptions",t instanceof Error?t:void 0)}}async save(t){try{const e=G.toRecord(t);return await this.db.consumptions.put(e),t}catch(e){throw new m("create","consumptions",e instanceof Error?e:void 0,t.id)}}async delete(t){try{await this.db.consumptions.delete(t)}catch(e){throw new m("delete","consumptions",e instanceof Error?e:void 0,t)}}async findByTripId(t){try{const e=await this.db.consumptions.where("tripId").equals(t).toArray();return G.toDomainPropsList(e).map(r=>this.consumptionFactory(r))}catch(e){throw new m("findByIndex","consumptions",e instanceof Error?e:void 0,t)}}async findByParticipantId(t){try{const e=await this.db.consumptions.where("participantId").equals(t).toArray();return G.toDomainPropsList(e).map(r=>this.consumptionFactory(r))}catch(e){throw new m("findByIndex","consumptions",e instanceof Error?e:void 0,t)}}async findByProductId(t){try{const e=await this.db.consumptions.where("productId").equals(t).toArray();return G.toDomainPropsList(e).map(r=>this.consumptionFactory(r))}catch(e){throw new m("findByIndex","consumptions",e instanceof Error?e:void 0,t)}}async findByTripIdAndDate(t,e){try{const i=G.toDateOnlyString(e),r=await this.db.consumptions.where("tripId").equals(t).filter(n=>n.date.startsWith(i)).toArray();return G.toDomainPropsList(r).map(n=>this.consumptionFactory(n))}catch(i){throw new m("findByIndex","consumptions",i instanceof Error?i:void 0,t)}}async findByTripIdAndParticipantId(t,e){try{const i=await this.db.consumptions.where("[tripId+participantId]").equals([t,e]).toArray();return G.toDomainPropsList(i).map(s=>this.consumptionFactory(s))}catch(i){throw new m("findByIndex","consumptions",i instanceof Error?i:void 0)}}async findByTripIdAndProductId(t,e){try{const i=await this.db.consumptions.where("[tripId+productId]").equals([t,e]).toArray();return G.toDomainPropsList(i).map(s=>this.consumptionFactory(s))}catch(i){throw new m("findByIndex","consumptions",i instanceof Error?i:void 0)}}async findByTripIdAndMeal(t,e){try{const i=await this.db.consumptions.where("tripId").equals(t).filter(s=>s.meal===e).toArray();return G.toDomainPropsList(i).map(s=>this.consumptionFactory(s))}catch(i){throw new m("findByIndex","consumptions",i instanceof Error?i:void 0)}}async findByTripIdAndDateRange(t,e,i){try{const r=e.toISOString(),s=i.toISOString(),n=await this.db.consumptions.where("tripId").equals(t).filter(l=>l.date>=r&&l.date<=s).toArray();return G.toDomainPropsList(n).map(l=>this.consumptionFactory(l))}catch(r){throw new m("findByIndex","consumptions",r instanceof Error?r:void 0)}}async exists(t){try{return await this.db.consumptions.where("id").equals(t).count()>0}catch(e){throw new m("find","consumptions",e instanceof Error?e:void 0,t)}}async update(t,e){try{const i=await this.db.consumptions.get(t);if(!i)return null;const r={...i,...e};await this.db.consumptions.put(r);const s=G.toDomainProps(r);return this.consumptionFactory(s)}catch(i){throw new m("update","consumptions",i instanceof Error?i:void 0,t)}}async deleteByTripId(t){try{return await this.db.consumptions.where("tripId").equals(t).delete()}catch(e){throw new m("delete","consumptions",e instanceof Error?e:void 0,t)}}async deleteByParticipantId(t){try{return await this.db.consumptions.where("participantId").equals(t).delete()}catch(e){throw new m("delete","consumptions",e instanceof Error?e:void 0,t)}}async deleteByProductId(t){try{return await this.db.consumptions.where("productId").equals(t).delete()}catch(e){throw new m("delete","consumptions",e instanceof Error?e:void 0,t)}}async count(){try{return await this.db.consumptions.count()}catch(t){throw new m("count","consumptions",t instanceof Error?t:void 0)}}async countByTripId(t){try{return await this.db.consumptions.where("tripId").equals(t).count()}catch(e){throw new m("count","consumptions",e instanceof Error?e:void 0)}}async deleteMany(t){try{await this.db.consumptions.bulkDelete(t)}catch(e){throw new m("delete","consumptions",e instanceof Error?e:void 0)}}async saveMany(t){try{const e=G.toRecordList(t);return await this.db.consumptions.bulkPut(e),t}catch(e){throw new m("create","consumptions",e instanceof Error?e:void 0)}}async sumQuantityByTripIdAndProductId(t,e){try{return(await this.db.consumptions.where("[tripId+productId]").equals([t,e]).toArray()).reduce((r,s)=>r+s.quantity,0)}catch(i){throw new m("find","consumptions",i instanceof Error?i:void 0)}}}const yt=class yt{constructor(){}static isValidMealType(t){return yt.VALID_MEALS.includes(t)}static validateMeals(t){const e=[];for(const i of t){if(!yt.isValidMealType(i))throw new Error(`Invalid meal type: ${i}. Expected one of: ${yt.VALID_MEALS.join(", ")}.`);e.push(i)}return e}static toRecord(t){return{id:t.id,participantId:t.participantId,tripId:t.tripId,date:t.date.toISOString(),meals:[...t.meals]}}static toDomainProps(t){return{id:t.id,participantId:t.participantId,tripId:t.tripId,date:new Date(t.date),meals:yt.validateMeals(t.meals)}}static toDomainPropsList(t){return t.map(e=>yt.toDomainProps(e))}static toRecordList(t){return t.map(e=>yt.toRecord(e))}static toPartialRecord(t){const e={};return t.date!==void 0&&(e.date=t.date.toISOString()),t.meals!==void 0&&(e.meals=[...t.meals]),e}static toDateOnlyString(t){return t.toISOString().split("T")[0]??""}static createCompositeKey(t,e,i){const r=yt.toDateOnlyString(i);return`${t}:${e}:${r}`}};f(yt,"VALID_MEALS",["breakfast","lunch","dinner","snack"]);let H=yt;class aa{constructor(t,e){f(this,"db");f(this,"availabilityFactory");this.db=t,this.availabilityFactory=e}async findById(t){try{const e=await this.db.availabilities.get(t);if(!e)return null;const i=H.toDomainProps(e);return this.availabilityFactory(i)}catch(e){throw new m("findById","availabilities",e instanceof Error?e:void 0,t)}}async findAll(){try{const t=await this.db.availabilities.toArray();return H.toDomainPropsList(t).map(i=>this.availabilityFactory(i))}catch(t){throw new m("findAll","availabilities",t instanceof Error?t:void 0)}}async save(t){try{const e=H.toRecord(t);return await this.db.availabilities.put(e),t}catch(e){throw new m("create","availabilities",e instanceof Error?e:void 0,t.id)}}async delete(t){try{await this.db.availabilities.delete(t)}catch(e){throw new m("delete","availabilities",e instanceof Error?e:void 0,t)}}async findByTripId(t){try{const e=await this.db.availabilities.where("tripId").equals(t).toArray();return H.toDomainPropsList(e).map(r=>this.availabilityFactory(r))}catch(e){throw new m("findByIndex","availabilities",e instanceof Error?e:void 0,t)}}async findByParticipantId(t){try{const e=await this.db.availabilities.where("participantId").equals(t).toArray();return H.toDomainPropsList(e).map(r=>this.availabilityFactory(r))}catch(e){throw new m("findByIndex","availabilities",e instanceof Error?e:void 0,t)}}async findByTripIdAndDate(t,e){try{const i=H.toDateOnlyString(e),r=await this.db.availabilities.where("tripId").equals(t).filter(n=>n.date.startsWith(i)).toArray();return H.toDomainPropsList(r).map(n=>this.availabilityFactory(n))}catch(i){throw new m("findByIndex","availabilities",i instanceof Error?i:void 0,t)}}async findByParticipantIdAndDate(t,e){try{const i=H.toDateOnlyString(e),r=await this.db.availabilities.where("participantId").equals(t).filter(n=>n.date.startsWith(i)).first();if(!r)return null;const s=H.toDomainProps(r);return this.availabilityFactory(s)}catch(i){throw new m("findByIndex","availabilities",i instanceof Error?i:void 0,t)}}async findByParticipantIdAndTripId(t,e){try{const i=await this.db.availabilities.where("[participantId+tripId]").equals([t,e]).toArray();return H.toDomainPropsList(i).map(s=>this.availabilityFactory(s))}catch(i){throw new m("findByIndex","availabilities",i instanceof Error?i:void 0)}}async findByTripIdAndDateRange(t,e,i){try{const r=e.toISOString(),s=i.toISOString(),n=await this.db.availabilities.where("tripId").equals(t).filter(l=>l.date>=r&&l.date<=s).toArray();return H.toDomainPropsList(n).map(l=>this.availabilityFactory(l))}catch(r){throw new m("findByIndex","availabilities",r instanceof Error?r:void 0)}}async findByTripIdDateAndMeal(t,e,i){try{const r=H.toDateOnlyString(e),s=await this.db.availabilities.where("tripId").equals(t).filter(c=>c.date.startsWith(r)&&c.meals.includes(i)).toArray();return H.toDomainPropsList(s).map(c=>this.availabilityFactory(c))}catch(r){throw new m("findByIndex","availabilities",r instanceof Error?r:void 0)}}async exists(t){try{return await this.db.availabilities.where("id").equals(t).count()>0}catch(e){throw new m("find","availabilities",e instanceof Error?e:void 0,t)}}async update(t,e){try{const i=await this.db.availabilities.get(t);if(!i)return null;const r={...i,...e};await this.db.availabilities.put(r);const s=H.toDomainProps(r);return this.availabilityFactory(s)}catch(i){throw new m("update","availabilities",i instanceof Error?i:void 0,t)}}async updateMeals(t,e){return this.update(t,{meals:e})}async deleteByParticipantId(t){try{return await this.db.availabilities.where("participantId").equals(t).delete()}catch(e){throw new m("delete","availabilities",e instanceof Error?e:void 0,t)}}async deleteByTripId(t){try{return await this.db.availabilities.where("tripId").equals(t).delete()}catch(e){throw new m("delete","availabilities",e instanceof Error?e:void 0,t)}}async count(){try{return await this.db.availabilities.count()}catch(t){throw new m("count","availabilities",t instanceof Error?t:void 0)}}async countByTripId(t){try{return await this.db.availabilities.where("tripId").equals(t).count()}catch(e){throw new m("count","availabilities",e instanceof Error?e:void 0)}}async countByParticipantId(t){try{return await this.db.availabilities.where("participantId").equals(t).count()}catch(e){throw new m("count","availabilities",e instanceof Error?e:void 0)}}async deleteMany(t){try{await this.db.availabilities.bulkDelete(t)}catch(e){throw new m("delete","availabilities",e instanceof Error?e:void 0)}}async saveMany(t){try{const e=H.toRecordList(t);return await this.db.availabilities.bulkPut(e),t}catch(e){throw new m("create","availabilities",e instanceof Error?e:void 0)}}async upsertByParticipantAndDate(t){try{const e=await this.findByParticipantIdAndDate(t.participantId,t.date);return e?(await this.update(e.id,{meals:[...t.meals]}),t):this.save(t)}catch(e){throw new m("create","availabilities",e instanceof Error?e:void 0,t.id)}}}const U=[];for(let o=0;o<256;++o)U.push((o+256).toString(16).slice(1));function ia(o,t=0){return(U[o[t+0]]+U[o[t+1]]+U[o[t+2]]+U[o[t+3]]+"-"+U[o[t+4]]+U[o[t+5]]+"-"+U[o[t+6]]+U[o[t+7]]+"-"+U[o[t+8]]+U[o[t+9]]+"-"+U[o[t+10]]+U[o[t+11]]+U[o[t+12]]+U[o[t+13]]+U[o[t+14]]+U[o[t+15]]).toLowerCase()}let ae;const ra=new Uint8Array(16);function sa(){if(!ae){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ae=crypto.getRandomValues.bind(crypto)}return ae(ra)}const na=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fe={randomUUID:na};function Ot(o,t,e){var r;if(fe.randomUUID&&!o)return fe.randomUUID();o=o||{};const i=o.random??((r=o.rng)==null?void 0:r.call(o))??sa();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,ia(i)}var Ct=(o=>(o.DOMAIN_ERROR="DOMAIN_ERROR",o.VALIDATION_ERROR="VALIDATION_ERROR",o.NOT_FOUND_ERROR="NOT_FOUND_ERROR",o.DUPLICATE_ERROR="DUPLICATE_ERROR",o.BUSINESS_RULE_ERROR="BUSINESS_RULE_ERROR",o.INVALID_OPERATION_ERROR="INVALID_OPERATION_ERROR",o))(Ct||{});class It extends Error{constructor(e,i="DOMAIN_ERROR",r){super(e);f(this,"code");f(this,"details");f(this,"timestamp");Object.setPrototypeOf(this,new.target.prototype),this.name=this.constructor.name,this.code=i,this.details=r,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}toJSON(e=!1){const i={name:this.name,code:this.code,message:this.message,timestamp:this.timestamp.toISOString()};return this.details!==void 0?{...i,details:this.details}:e&&this.stack?{...i,stack:this.stack}:i}toString(){const e=`${this.name} [${this.code}]: ${this.message}`;return this.details?`${e}
Details: ${JSON.stringify(this.details,null,2)}`:e}static isDomainError(e){return e instanceof It}}class _ extends It{constructor(e,i,r,s){const n={};i!==void 0&&(n.field=i),r!==void 0&&(n.rule=r),s!==void 0&&(n.value=s);super(e,Ct.VALIDATION_ERROR,Object.keys(n).length>0?n:void 0);f(this,"field");f(this,"rule");f(this,"failures");this.field=i,this.rule=r,i&&r?this.failures=[{field:i,rule:r,message:e,value:s}]:this.failures=[]}static fromFailures(e){if(e.length===0)return new _("Validation failed with no specific errors");if(e.length===1){const s=e[0];return new _(s.message,s.field,s.rule,s.value)}const i=`Validation failed with ${e.length} errors: ${e.map(s=>s.message).join("; ")}`,r=new _(i);return Object.defineProperty(r,"failures",{value:e,writable:!1,enumerable:!0,configurable:!1}),r}static required(e,i){const r=i?`${i} `:"";return new _(`${r}${e} is required`,e,"required")}static invalidFormat(e,i,r){return new _(`${e} must be a ${i}`,e,"format",r)}static outOfRange(e,i,r,s){let n;return i!==void 0&&r!==void 0?n=`${e} must be between ${i} and ${r}`:i!==void 0?n=`${e} must be at least ${i}`:r!==void 0?n=`${e} must be at most ${r}`:n=`${e} is out of range`,new _(n,e,"range",s)}static invalidLength(e,i,r,s){let n;return i!==void 0&&r!==void 0?n=`${e} must be between ${i} and ${r} characters`:i!==void 0?n=`${e} must be at least ${i} characters`:r!==void 0?n=`${e} must be at most ${r} characters`:n=`${e} has invalid length`,new _(n,e,"length",s)}static invalidDateRange(e,i){return new _(`${e} must be before ${i}`,`${e}_${i}`,"dateRange")}hasMultipleFailures(){return this.failures.length>1}getFailedFields(){return this.failures.map(e=>e.field)}static isValidationError(e){return e instanceof _}}class S extends It{constructor(e,i,r){const s=S.buildMessage(e,i,r),n={entityType:e};i!==void 0&&(n.entityId=i),r!==void 0&&(n.searchCriteria=r);super(s,Ct.NOT_FOUND_ERROR,n);f(this,"entityType");f(this,"entityId");f(this,"searchCriteria");this.entityType=e,this.entityId=i,this.searchCriteria=r}static buildMessage(e,i,r){if(i!==void 0)return`${e} with ID '${i}' was not found`;if(r!==void 0){const s=Object.entries(r).map(([n,c])=>`${n}=${JSON.stringify(c)}`).join(", ");return`${e} matching criteria {${s}} was not found`}return`${e} was not found`}static forEntity(e,i){return new S(e,i)}static forQuery(e,i){return new S(e,void 0,i)}static tripNotFound(e){return S.forEntity("Trip",e)}static participantNotFound(e){return S.forEntity("Participant",e)}static productNotFound(e){return S.forEntity("Product",e)}static consumptionNotFound(e){return S.forEntity("Consumption",e)}static availabilityNotFound(e){return S.forEntity("Availability",e)}static isNotFoundError(e){return e instanceof S}}class at extends It{constructor(e,i,r,s){const n=at.buildMessage(e,i,r,s),c={entityType:e};i!==void 0&&(c.field=i),r!==void 0&&(c.duplicateValue=r),s!==void 0&&(c.compositeKey=s);super(n,Ct.DUPLICATE_ERROR,c);f(this,"entityType");f(this,"field");f(this,"duplicateValue");f(this,"compositeKey");this.entityType=e,this.field=i,this.duplicateValue=r,this.compositeKey=s}static buildMessage(e,i,r,s){if(s!==void 0){const n=Object.entries(s).map(([c,l])=>`${c}=${JSON.stringify(l)}`).join(", ");return`${e} with composite key {${n}} already exists`}return i!==void 0&&r!==void 0?`${e} with ${i} '${String(r)}' already exists`:i!==void 0?`${e} with duplicate ${i} already exists`:`${e} already exists`}static forField(e,i,r){return new at(e,i,r)}static forId(e,i){return new at(e,"id",i)}static forCompositeKey(e,i){return new at(e,void 0,void 0,i)}static tripNameExists(e){return at.forField("Trip","name",e)}static participantExistsInTrip(e,i){return at.forCompositeKey("Participant",{name:e,tripId:i})}static productNameExists(e){return at.forField("Product","name",e)}static availabilityExists(e,i,r){return at.forCompositeKey("Availability",{participantId:e,tripId:i,date:r})}static isDuplicateError(e){return e instanceof at}}const Mt=["breakfast","lunch","dinner","snack"],ve={breakfast:1,lunch:2,snack:3,dinner:4};function Ce(o){return typeof o=="string"&&Mt.includes(o)}function oa(o){return[...o].sort((t,e)=>ve[t]-ve[e])}const Pe=["food","beverage","other"],De=["meat","dairy","vegetables","fruits","grains","snacks","condiments","prepared_food","water","soft_drink","alcohol","hot_beverage","miscellaneous"],ca={meat:"food",dairy:"food",vegetables:"food",fruits:"food",grains:"food",snacks:"food",condiments:"food",prepared_food:"food",water:"beverage",soft_drink:"beverage",alcohol:"beverage",hot_beverage:"beverage",miscellaneous:"other"},Ae=["kg","g","lb","oz","l","ml","gal","unit","pack","box","bottle","can","bag","serving","portion","slice","piece"];function la(o){return typeof o=="string"&&Pe.includes(o)}function da(o){return typeof o=="string"&&De.includes(o)}function pa(o){return typeof o=="string"&&Ae.includes(o)}function ua(o){return ca[o]}function ha(o,t){if(o>t)throw new Error("Start date must be before or equal to end date");return{startDate:new Date(o),endDate:new Date(t)}}function ma(o,t){const e=o.getTime();return e>=t.startDate.getTime()&&e<=t.endDate.getTime()}function ya(o){const e=o.endDate.getTime()-o.startDate.getTime();return Math.floor(e/864e5)+1}const fa=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function va(o){return fa.test(o)}function Ut(o){const t=new Date(o);return t.setHours(0,0,0,0),t}const q=class q{constructor(t){f(this,"id");f(this,"name");f(this,"description");f(this,"startDate");f(this,"endDate");f(this,"createdAt");f(this,"updatedAt");this.id=t.id,this.name=t.name,this.description=t.description,this.startDate=new Date(t.startDate),this.endDate=new Date(t.endDate),this.createdAt=new Date(t.createdAt),this.updatedAt=t.updatedAt?new Date(t.updatedAt):void 0,Object.freeze(this)}static create(t){var i;q.validateName(t.name),t.description!==void 0&&q.validateDescription(t.description),q.validateDateRange(t.startDate,t.endDate);const e=new Date;return new q({id:Ot(),name:t.name.trim(),description:(i=t.description)==null?void 0:i.trim(),startDate:t.startDate,endDate:t.endDate,createdAt:e})}static fromPersistence(t){return new q(t)}update(t){const e=t.name!==void 0?t.name:this.name,i=t.description===null?void 0:t.description!==void 0?t.description:this.description,r=t.startDate!==void 0?t.startDate:this.startDate,s=t.endDate!==void 0?t.endDate:this.endDate;return t.name!==void 0&&q.validateName(t.name),t.description!==void 0&&t.description!==null&&q.validateDescription(t.description),(t.startDate!==void 0||t.endDate!==void 0)&&q.validateDateRange(r,s),new q({id:this.id,name:e.trim(),description:i==null?void 0:i.trim(),startDate:r,endDate:s,createdAt:this.createdAt,updatedAt:new Date})}getDateRange(){return ha(this.startDate,this.endDate)}getDurationInDays(){return ya(this.getDateRange())}isDateWithinTrip(t){return ma(t,this.getDateRange())}isActive(){return this.isDateWithinTrip(new Date)}hasStarted(){return new Date>=this.startDate}hasEnded(){return new Date>this.endDate}isUpcoming(){return new Date<this.startDate}toJSON(){return{id:this.id,name:this.name,description:this.description,startDate:this.startDate,endDate:this.endDate,createdAt:this.createdAt,updatedAt:this.updatedAt}}static validateName(t){if(!t||typeof t!="string")throw _.required("name","Trip");const e=t.trim();if(e.length<q.MIN_NAME_LENGTH||e.length>q.MAX_NAME_LENGTH)throw _.invalidLength("name",q.MIN_NAME_LENGTH,q.MAX_NAME_LENGTH,e.length)}static validateDescription(t){if(t.length>q.MAX_DESCRIPTION_LENGTH)throw _.invalidLength("description",void 0,q.MAX_DESCRIPTION_LENGTH,t.length)}static validateDateRange(t,e){if(!t||!(t instanceof Date)||isNaN(t.getTime()))throw _.required("startDate","Trip");if(!e||!(e instanceof Date)||isNaN(e.getTime()))throw _.required("endDate","Trip");if(t>e)throw _.invalidDateRange("startDate","endDate")}equals(t){return t instanceof q?this.id===t.id:!1}};f(q,"MIN_NAME_LENGTH",3),f(q,"MAX_NAME_LENGTH",100),f(q,"MAX_DESCRIPTION_LENGTH",500);let Ht=q;const ge=Object.freeze(Object.defineProperty({__proto__:null,Trip:Ht},Symbol.toStringTag,{value:"Module"})),O=class O{constructor(t){f(this,"id");f(this,"tripId");f(this,"name");f(this,"email");f(this,"notes");f(this,"createdAt");f(this,"updatedAt");this.id=t.id,this.tripId=t.tripId,this.name=t.name,this.email=t.email,this.notes=t.notes,this.createdAt=new Date(t.createdAt),this.updatedAt=t.updatedAt?new Date(t.updatedAt):void 0,Object.freeze(this)}static create(t){var i,r;O.validateTripId(t.tripId),O.validateName(t.name),t.email!==void 0&&O.validateEmail(t.email),t.notes!==void 0&&O.validateNotes(t.notes);const e=new Date;return new O({id:Ot(),tripId:t.tripId,name:t.name.trim(),email:(i=t.email)==null?void 0:i.trim().toLowerCase(),notes:(r=t.notes)==null?void 0:r.trim(),createdAt:e})}static fromPersistence(t){return new O(t)}update(t){const e=t.name!==void 0?t.name:this.name,i=t.email===null?void 0:t.email!==void 0?t.email:this.email,r=t.notes===null?void 0:t.notes!==void 0?t.notes:this.notes;return t.name!==void 0&&O.validateName(t.name),t.email!==void 0&&t.email!==null&&O.validateEmail(t.email),t.notes!==void 0&&t.notes!==null&&O.validateNotes(t.notes),new O({id:this.id,tripId:this.tripId,name:e.trim(),email:i==null?void 0:i.trim().toLowerCase(),notes:r==null?void 0:r.trim(),createdAt:this.createdAt,updatedAt:new Date})}hasEmail(){return this.email!==void 0&&this.email.length>0}hasNotes(){return this.notes!==void 0&&this.notes.length>0}belongsToTrip(t){return this.tripId===t}toJSON(){return{id:this.id,tripId:this.tripId,name:this.name,email:this.email,notes:this.notes,createdAt:this.createdAt,updatedAt:this.updatedAt}}static validateTripId(t){if(!t||typeof t!="string"||t.trim().length===0)throw _.required("tripId","Participant")}static validateName(t){if(!t||typeof t!="string")throw _.required("name","Participant");const e=t.trim();if(e.length<O.MIN_NAME_LENGTH||e.length>O.MAX_NAME_LENGTH)throw _.invalidLength("name",O.MIN_NAME_LENGTH,O.MAX_NAME_LENGTH,e.length)}static validateEmail(t){const e=t.trim();if(e.length>0&&!va(e))throw _.invalidFormat("email","valid email address",t)}static validateNotes(t){if(t.length>O.MAX_NOTES_LENGTH)throw _.invalidLength("notes",void 0,O.MAX_NOTES_LENGTH,t.length)}equals(t){return t instanceof O?this.id===t.id:!1}};f(O,"MIN_NAME_LENGTH",2),f(O,"MAX_NAME_LENGTH",100),f(O,"MAX_NOTES_LENGTH",500);let Gt=O;const xe=Object.freeze(Object.defineProperty({__proto__:null,Participant:Gt},Symbol.toStringTag,{value:"Module"})),k=class k{constructor(t){f(this,"id");f(this,"name");f(this,"category");f(this,"type");f(this,"unit");f(this,"defaultQuantityPerPerson");f(this,"notes");f(this,"createdAt");f(this,"updatedAt");this.id=t.id,this.name=t.name,this.category=t.category,this.type=t.type,this.unit=t.unit,this.defaultQuantityPerPerson=t.defaultQuantityPerPerson,this.notes=t.notes,this.createdAt=new Date(t.createdAt),this.updatedAt=t.updatedAt?new Date(t.updatedAt):void 0,Object.freeze(this)}static create(t){var i;k.validateName(t.name),k.validateCategory(t.category),k.validateType(t.type),k.validateTypeMatchesCategory(t.type,t.category),k.validateUnit(t.unit),t.defaultQuantityPerPerson!==void 0&&k.validateQuantity(t.defaultQuantityPerPerson),t.notes!==void 0&&k.validateNotes(t.notes);const e=new Date;return new k({id:Ot(),name:t.name.trim(),category:t.category,type:t.type,unit:t.unit,defaultQuantityPerPerson:t.defaultQuantityPerPerson,notes:(i=t.notes)==null?void 0:i.trim(),createdAt:e})}static fromPersistence(t){return new k(t)}update(t){const e=t.name!==void 0?t.name:this.name,i=t.category!==void 0?t.category:this.category,r=t.type!==void 0?t.type:this.type,s=t.unit!==void 0?t.unit:this.unit,n=t.defaultQuantityPerPerson===null?void 0:t.defaultQuantityPerPerson!==void 0?t.defaultQuantityPerPerson:this.defaultQuantityPerPerson,c=t.notes===null?void 0:t.notes!==void 0?t.notes:this.notes;return t.name!==void 0&&k.validateName(t.name),t.category!==void 0&&k.validateCategory(t.category),t.type!==void 0&&k.validateType(t.type),(t.type!==void 0||t.category!==void 0)&&k.validateTypeMatchesCategory(r,i),t.unit!==void 0&&k.validateUnit(t.unit),t.defaultQuantityPerPerson!==void 0&&t.defaultQuantityPerPerson!==null&&k.validateQuantity(t.defaultQuantityPerPerson),t.notes!==void 0&&t.notes!==null&&k.validateNotes(t.notes),new k({id:this.id,name:e.trim(),category:i,type:r,unit:s,defaultQuantityPerPerson:n,notes:c==null?void 0:c.trim(),createdAt:this.createdAt,updatedAt:new Date})}isFood(){return this.category==="food"}isBeverage(){return this.category==="beverage"}hasDefaultQuantity(){return this.defaultQuantityPerPerson!==void 0&&this.defaultQuantityPerPerson>0}calculateQuantityForPeople(t){if(!(!this.hasDefaultQuantity()||this.defaultQuantityPerPerson===void 0))return t<=0?0:this.defaultQuantityPerPerson*t}toJSON(){return{id:this.id,name:this.name,category:this.category,type:this.type,unit:this.unit,defaultQuantityPerPerson:this.defaultQuantityPerPerson,notes:this.notes,createdAt:this.createdAt,updatedAt:this.updatedAt}}static validateName(t){if(!t||typeof t!="string")throw _.required("name","Product");const e=t.trim();if(e.length<k.MIN_NAME_LENGTH||e.length>k.MAX_NAME_LENGTH)throw _.invalidLength("name",k.MIN_NAME_LENGTH,k.MAX_NAME_LENGTH,e.length)}static validateCategory(t){if(!la(t))throw new _(`Invalid product category: '${String(t)}'. Valid categories are: ${Pe.join(", ")}`,"category","enum")}static validateType(t){if(!da(t))throw new _(`Invalid product type: '${String(t)}'. Valid types are: ${De.join(", ")}`,"type","enum")}static validateTypeMatchesCategory(t,e){const i=ua(t);if(i!==e)throw new _(`Product type '${t}' does not belong to category '${e}'. Expected category: '${i}'`,"type","categoryMismatch")}static validateUnit(t){if(!pa(t))throw new _(`Invalid product unit: '${String(t)}'. Valid units are: ${Ae.join(", ")}`,"unit","enum")}static validateQuantity(t){if(typeof t!="number"||isNaN(t))throw _.invalidFormat("defaultQuantityPerPerson","number");if(t<k.MIN_QUANTITY||t>k.MAX_QUANTITY)throw _.outOfRange("defaultQuantityPerPerson",k.MIN_QUANTITY,k.MAX_QUANTITY,t)}static validateNotes(t){if(t.length>k.MAX_NOTES_LENGTH)throw _.invalidLength("notes",void 0,k.MAX_NOTES_LENGTH,t.length)}equals(t){return t instanceof k?this.id===t.id:!1}};f(k,"MIN_NAME_LENGTH",2),f(k,"MAX_NAME_LENGTH",100),f(k,"MAX_NOTES_LENGTH",500),f(k,"MIN_QUANTITY",.01),f(k,"MAX_QUANTITY",1e3);let Xt=k;const we=Object.freeze(Object.defineProperty({__proto__:null,Product:Xt},Symbol.toStringTag,{value:"Module"})),F=class F{constructor(t){f(this,"id");f(this,"tripId");f(this,"participantId");f(this,"productId");f(this,"date");f(this,"meal");f(this,"quantity");f(this,"createdAt");f(this,"updatedAt");this.id=t.id,this.tripId=t.tripId,this.participantId=t.participantId,this.productId=t.productId,this.date=Ut(new Date(t.date)),this.meal=t.meal,this.quantity=t.quantity,this.createdAt=new Date(t.createdAt),this.updatedAt=t.updatedAt?new Date(t.updatedAt):void 0,Object.freeze(this)}static create(t){F.validateTripId(t.tripId),F.validateParticipantId(t.participantId),F.validateProductId(t.productId),F.validateDate(t.date),F.validateMeal(t.meal),F.validateQuantity(t.quantity);const e=new Date;return new F({id:Ot(),tripId:t.tripId,participantId:t.participantId,productId:t.productId,date:t.date,meal:t.meal,quantity:t.quantity,createdAt:e})}static fromPersistence(t){return new F(t)}update(t){const e=t.date!==void 0?t.date:this.date,i=t.meal!==void 0?t.meal:this.meal,r=t.quantity!==void 0?t.quantity:this.quantity;return t.date!==void 0&&F.validateDate(t.date),t.meal!==void 0&&F.validateMeal(t.meal),t.quantity!==void 0&&F.validateQuantity(t.quantity),new F({id:this.id,tripId:this.tripId,participantId:this.participantId,productId:this.productId,date:e,meal:i,quantity:r,createdAt:this.createdAt,updatedAt:new Date})}belongsToTrip(t){return this.tripId===t}isFromParticipant(t){return this.participantId===t}isForProduct(t){return this.productId===t}isOnDate(t){const e=Ut(t);return this.date.getTime()===e.getTime()}isForMeal(t){return this.meal===t}getDateString(){return this.date.toISOString().split("T")[0]}toJSON(){return{id:this.id,tripId:this.tripId,participantId:this.participantId,productId:this.productId,date:this.date,meal:this.meal,quantity:this.quantity,createdAt:this.createdAt,updatedAt:this.updatedAt}}static validateTripId(t){if(!t||typeof t!="string"||t.trim().length===0)throw _.required("tripId","Consumption")}static validateParticipantId(t){if(!t||typeof t!="string"||t.trim().length===0)throw _.required("participantId","Consumption")}static validateProductId(t){if(!t||typeof t!="string"||t.trim().length===0)throw _.required("productId","Consumption")}static validateDate(t){if(!t||!(t instanceof Date)||isNaN(t.getTime()))throw _.required("date","Consumption")}static validateMeal(t){if(!Ce(t))throw new _(`Invalid meal type: '${String(t)}'. Valid types are: ${Mt.join(", ")}`,"meal","enum")}static validateQuantity(t){if(typeof t!="number"||isNaN(t))throw _.invalidFormat("quantity","number");if(t<F.MIN_QUANTITY||t>F.MAX_QUANTITY)throw _.outOfRange("quantity",F.MIN_QUANTITY,F.MAX_QUANTITY,t)}equals(t){return t instanceof F?this.id===t.id:!1}};f(F,"MIN_QUANTITY",.01),f(F,"MAX_QUANTITY",1e4);let Yt=F;const ie=Object.freeze(Object.defineProperty({__proto__:null,Consumption:Yt},Symbol.toStringTag,{value:"Module"}));class ot{constructor(t){f(this,"id");f(this,"participantId");f(this,"tripId");f(this,"date");f(this,"meals");f(this,"createdAt");f(this,"updatedAt");this.id=t.id,this.participantId=t.participantId,this.tripId=t.tripId,this.date=Ut(new Date(t.date)),this.meals=Object.freeze(oa([...new Set(t.meals)])),this.createdAt=new Date(t.createdAt),this.updatedAt=t.updatedAt?new Date(t.updatedAt):void 0,Object.freeze(this)}static create(t){ot.validateParticipantId(t.participantId),ot.validateTripId(t.tripId),ot.validateDate(t.date),ot.validateMeals(t.meals);const e=new Date;return new ot({id:Ot(),participantId:t.participantId,tripId:t.tripId,date:t.date,meals:t.meals,createdAt:e})}static fromPersistence(t){return new ot(t)}update(t){const e=t.date!==void 0?t.date:this.date,i=t.meals!==void 0?t.meals:this.meals;return t.date!==void 0&&ot.validateDate(t.date),t.meals!==void 0&&ot.validateMeals(t.meals),new ot({id:this.id,participantId:this.participantId,tripId:this.tripId,date:e,meals:i,createdAt:this.createdAt,updatedAt:new Date})}isAvailableForMeal(t){return this.meals.includes(t)}isAvailableForAllMeals(){return Mt.every(t=>this.meals.includes(t))}isNotAvailable(){return this.meals.length===0}getMealCount(){return this.meals.length}addMeal(t){return this.isAvailableForMeal(t)?this:this.update({meals:[...this.meals,t]})}removeMeal(t){return this.isAvailableForMeal(t)?this.update({meals:this.meals.filter(e=>e!==t)}):this}setAvailableForAllMeals(){return this.update({meals:[...Mt]})}clearAllMeals(){return this.update({meals:[]})}belongsToTrip(t){return this.tripId===t}isForParticipant(t){return this.participantId===t}isOnDate(t){const e=Ut(t);return this.date.getTime()===e.getTime()}getDateString(){return this.date.toISOString().split("T")[0]}toJSON(){return{id:this.id,participantId:this.participantId,tripId:this.tripId,date:this.date,meals:[...this.meals],createdAt:this.createdAt,updatedAt:this.updatedAt}}static validateParticipantId(t){if(!t||typeof t!="string"||t.trim().length===0)throw _.required("participantId","Availability")}static validateTripId(t){if(!t||typeof t!="string"||t.trim().length===0)throw _.required("tripId","Availability")}static validateDate(t){if(!t||!(t instanceof Date)||isNaN(t.getTime()))throw _.required("date","Availability")}static validateMeals(t){if(!Array.isArray(t))throw new _("meals must be an array","meals","type");for(const e of t)if(!Ce(e))throw new _(`Invalid meal type: '${String(e)}'. Valid types are: ${Mt.join(", ")}`,"meals","enum")}equals(t){return t instanceof ot?this.id===t.id:!1}}const ga=Object.freeze(Object.defineProperty({__proto__:null,Availability:ot},Symbol.toStringTag,{value:"Module"})),xa="modulepreload",wa=function(o){return"/tripfood-manager/"+o},_e={},vt=function(t,e,i){let r=Promise.resolve();if(e&&e.length>0){let n=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),l=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=n(e.map(d=>{if(d=wa(d),d in _e)return;_e[d]=!0;const h=d.endsWith(".css"),w=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${w}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":xa,h||(g.as="script"),g.crossOrigin="",g.href=d,l&&g.setAttribute("nonce",l),document.head.appendChild(g),h)return new Promise((b,I)=>{g.addEventListener("load",b),g.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(n){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=n,window.dispatchEvent(c),!c.defaultPrevented)throw n}return r.then(n=>{for(const c of n||[])c.status==="rejected"&&s(c.reason);return t().catch(s)})};class _a{constructor(t,e,i,r){this.tripRepository=t,this.participantRepository=e,this.consumptionRepository=i,this.availabilityRepository=r}async create(t){this.validateCreateDTO(t);const{Trip:e}=await vt(async()=>{const{Trip:r}=await Promise.resolve().then(()=>ge);return{Trip:r}},void 0),i=e.create({name:t.name,description:t.description,startDate:t.startDate,endDate:t.endDate});return this.tripRepository.save(i)}async createTrip(t){const{Trip:e}=await vt(async()=>{const{Trip:r}=await Promise.resolve().then(()=>ge);return{Trip:r}},void 0),i=e.create(t);return this.tripRepository.save(i)}async getById(t){return this.tripRepository.findById(t)}async getTripById(t){const e=await this.tripRepository.findById(t);if(!e)throw S.withId("Trip",t);return e}async getDetails(t){const e=await this.tripRepository.findById(t);if(!e)throw S.withId("Trip",t);const i=this.participantRepository?await this.participantRepository.findByTripId(t):[],r=this.consumptionRepository?(await this.consumptionRepository.findByTripId(t)).length:0;return this.toDetailResponseDTO(e,i,r)}async getAll(){return this.tripRepository.findAll()}async getAllTrips(){return this.tripRepository.findAll()}async getAllTripsOrderedByStartDate(){return this.tripRepository.findAllOrderedByStartDate()}async getAllAsResponseDTO(){const t=await this.tripRepository.findAll(),e=[];for(const i of t){const r=this.participantRepository?await this.participantRepository.countByTripId(i.id):0;e.push(this.toResponseDTO(i,r))}return e}async searchByName(t){return this.tripRepository.findByName(t)}async searchTripsByName(t){return this.tripRepository.findByName(t)}async findTripsByDate(t){return this.tripRepository.findByDate(t)}async findTripsByDateRange(t,e){if(t>e)throw _.invalidDateRange("startDate","endDate");return this.tripRepository.findByDateRange(t,e)}async update(t,e){const i=await this.tripRepository.findById(t);if(!i)throw S.withId("Trip",t);this.validateUpdateDTO(e,i);const r=i.update({name:e.name,description:e.description,startDate:e.startDate,endDate:e.endDate});return this.tripRepository.save(r)}async updateTrip(t,e){const r=(await this.getTripById(t)).update(e);return this.tripRepository.save(r)}async delete(t,e=!1){if(!await this.tripRepository.exists(t))throw S.withId("Trip",t);if(this.participantRepository&&!e){const r=await this.participantRepository.countByTripId(t);if(r>0)throw new It(`Cannot delete trip with ${r} participant(s). Use force=true to delete all related data.`,Ct.BUSINESS_RULE_ERROR,{tripId:t,participantCount:r})}e&&(this.consumptionRepository&&await this.consumptionRepository.deleteByTripId(t),this.availabilityRepository&&await this.availabilityRepository.deleteByTripId(t),this.participantRepository&&await this.participantRepository.deleteByTripId(t)),await this.tripRepository.delete(t)}async deleteTrip(t){if(!await this.tripRepository.exists(t))throw S.withId("Trip",t);await this.tripRepository.delete(t)}async exists(t){return this.tripRepository.exists(t)}async tripExists(t){return this.tripRepository.exists(t)}async count(){return this.tripRepository.count()}async getTripCount(){return this.tripRepository.count()}validateCreateDTO(t){if(!t.name||t.name.trim().length===0)throw _.required("name","Trip");if(!t.startDate)throw _.required("startDate","Trip");if(!t.endDate)throw _.required("endDate","Trip");if(!(t.startDate instanceof Date)||isNaN(t.startDate.getTime()))throw _.invalidFormat("startDate","valid Date");if(!(t.endDate instanceof Date)||isNaN(t.endDate.getTime()))throw _.invalidFormat("endDate","valid Date");if(t.startDate>t.endDate)throw _.invalidDateRange("startDate","endDate")}validateUpdateDTO(t,e){if(t.name!==void 0&&t.name.trim().length===0)throw _.invalidLength("name",1,void 0,0);const i=t.startDate??e.startDate,r=t.endDate??e.endDate;if(i>r)throw _.invalidDateRange("startDate","endDate")}toResponseDTO(t,e){return{id:t.id,name:t.name,description:t.description,startDate:t.startDate,endDate:t.endDate,durationDays:t.getDurationInDays(),participantCount:e,createdAt:t.createdAt,updatedAt:t.updatedAt??t.createdAt}}toDetailResponseDTO(t,e,i){return{...this.toResponseDTO(t,e.length),participants:e.map(r=>({id:r.id,name:r.name})),productCount:0,consumptionCount:i}}}class ba{constructor(t,e,i,r){this.participantRepository=t,this.tripRepository=e,this.consumptionRepository=i,this.availabilityRepository=r}async create(t){if(this.validateCreateDTO(t),!await this.tripRepository.exists(t.tripId))throw S.withId("Trip",t.tripId);if(await this.participantRepository.findByTripIdAndName(t.tripId,t.name))throw at.withField("Participant","name",t.name);const{Participant:r}=await vt(async()=>{const{Participant:n}=await Promise.resolve().then(()=>xe);return{Participant:n}},void 0),s=r.create({tripId:t.tripId,name:t.name,email:t.email,notes:t.notes});return this.participantRepository.save(s)}async createParticipant(t){if(!await this.tripRepository.exists(t.tripId))throw S.withId("Trip",t.tripId);if(await this.participantRepository.findByTripIdAndName(t.tripId,t.name))throw at.withField("Participant","name",t.name);const{Participant:r}=await vt(async()=>{const{Participant:n}=await Promise.resolve().then(()=>xe);return{Participant:n}},void 0),s=r.create(t);return this.participantRepository.save(s)}async getById(t){return this.participantRepository.findById(t)}async getParticipantById(t){const e=await this.participantRepository.findById(t);if(!e)throw S.withId("Participant",t);return e}async getByTripId(t){if(!await this.tripRepository.exists(t))throw S.withId("Trip",t);return this.participantRepository.findByTripId(t)}async getParticipantsByTripId(t){if(!await this.tripRepository.exists(t))throw S.withId("Trip",t);return this.participantRepository.findByTripId(t)}async getParticipantsWithAvailability(t){const e=await this.getByTripId(t);if(!this.availabilityRepository)return e.map(r=>this.toWithAvailabilityDTO(r,[],0));const i=[];for(const r of e){const n=(await this.availabilityRepository.findByParticipantId(r.id)).map(h=>h.date),c=await this.tripRepository.findById(t),l=c?c.getDurationInDays():1,d=n.length/l*100;i.push(this.toWithAvailabilityDTO(r,n,d))}return i}async update(t,e){const i=await this.getParticipantById(t);if(this.validateUpdateDTO(e),e.name&&e.name!==i.name){const s=await this.participantRepository.findByTripIdAndName(i.tripId,e.name);if(s&&s.id!==t)throw at.withField("Participant","name",e.name)}const r=i.update({name:e.name,email:e.email,notes:e.notes});return this.participantRepository.save(r)}async updateParticipant(t,e){const i=await this.getParticipantById(t);if(e.name&&e.name!==i.name){const s=await this.participantRepository.findByTripIdAndName(i.tripId,e.name);if(s&&s.id!==t)throw at.withField("Participant","name",e.name)}const r=i.update(e);return this.participantRepository.save(r)}async delete(t,e=!1){if(!await this.participantRepository.exists(t))throw S.withId("Participant",t);if(this.consumptionRepository&&!e){const r=await this.consumptionRepository.findByParticipantId(t);if(r.length>0)throw new It(`Cannot delete participant with ${r.length} consumption record(s). Use force=true to delete all related data.`,Ct.BUSINESS_RULE_ERROR,{participantId:t,consumptionCount:r.length})}e&&(this.consumptionRepository&&await this.consumptionRepository.deleteByParticipantId(t),this.availabilityRepository&&await this.availabilityRepository.deleteByParticipantId(t)),await this.participantRepository.delete(t)}async deleteParticipant(t){if(!await this.participantRepository.exists(t))throw S.withId("Participant",t);await this.participantRepository.delete(t)}async deleteByTripId(t){return this.participantRepository.deleteByTripId(t)}async deleteParticipantsByTripId(t){return this.participantRepository.deleteByTripId(t)}async countByTripId(t){return this.participantRepository.countByTripId(t)}async getParticipantCountByTripId(t){return this.participantRepository.countByTripId(t)}async searchByName(t){return this.participantRepository.findByName(t)}async searchParticipantsByName(t){return this.participantRepository.findByName(t)}async searchByEmail(t){return this.participantRepository.findByEmail(t)}async exists(t){return this.participantRepository.exists(t)}validateCreateDTO(t){if(!t.tripId||t.tripId.trim().length===0)throw _.required("tripId","Participant");if(!t.name||t.name.trim().length===0)throw _.required("name","Participant");if(t.email&&!this.isValidEmail(t.email))throw _.invalidFormat("email","valid email address",t.email)}validateUpdateDTO(t){if(t.name!==void 0&&t.name.trim().length===0)throw _.invalidLength("name",1,void 0,0);if(t.email!==void 0&&t.email!==null&&!this.isValidEmail(t.email))throw _.invalidFormat("email","valid email address",t.email)}isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}toResponseDTO(t){return{id:t.id,tripId:t.tripId,name:t.name,email:t.email,notes:t.notes,dietaryRestrictions:[],createdAt:t.createdAt,updatedAt:t.updatedAt??t.createdAt}}toWithAvailabilityDTO(t,e,i){return{...this.toResponseDTO(t),availableDates:e,availabilityPercentage:i}}}class ja{constructor(t,e){this.productRepository=t,this.consumptionRepository=e}async create(t){this.validateCreateDTO(t);const{Product:e}=await vt(async()=>{const{Product:r}=await Promise.resolve().then(()=>we);return{Product:r}},void 0),i=e.create(t);return this.productRepository.save(i)}async createProduct(t){const{Product:e}=await vt(async()=>{const{Product:r}=await Promise.resolve().then(()=>we);return{Product:r}},void 0),i=e.create(t);return this.productRepository.save(i)}async getById(t){return this.productRepository.findById(t)}async getProductById(t){const e=await this.productRepository.findById(t);if(!e)throw S.withId("Product",t);return e}async getAll(){return this.productRepository.findAll()}async getAllProducts(){return this.productRepository.findAll()}async getFiltered(t){let e=await this.productRepository.findAll();if(t.category&&(e=e.filter(i=>i.category===t.category)),t.type&&(e=e.filter(i=>i.type===t.type)),t.name){const i=t.name.toLowerCase();e=e.filter(r=>r.name.toLowerCase().includes(i))}return t.hasDefaultQuantity!==void 0&&(e=e.filter(i=>t.hasDefaultQuantity?i.defaultQuantityPerPerson!==void 0&&i.defaultQuantityPerPerson>0:i.defaultQuantityPerPerson===void 0||i.defaultQuantityPerPerson===0)),e}async getByCategory(t){return this.productRepository.findByCategory(t)}async getProductsByCategory(t){return this.productRepository.findByCategory(t)}async getByType(t){return this.productRepository.findByType(t)}async getProductsByType(t){return this.productRepository.findByType(t)}async getGroupedByCategory(){const t=await this.productRepository.findAll(),e=new Map;for(const i of t){const r=i.category;e.has(r)||e.set(r,[]),e.get(r).push(i)}return e}async getProductsWithConsumption(t){const e=await this.productRepository.findAll();if(!this.consumptionRepository)return e.map(s=>this.toWithConsumptionDTO(s,0,0));const i=await this.consumptionRepository.findByTripId(t),r=new Map;for(const s of i){const n=r.get(s.productId)||{totalQuantity:0,count:0};r.set(s.productId,{totalQuantity:n.totalQuantity+s.quantity,count:n.count+1})}return e.map(s=>{const n=r.get(s.id)||{totalQuantity:0,count:0};return this.toWithConsumptionDTO(s,n.totalQuantity,n.count)})}async searchByName(t){return this.productRepository.findByName(t)}async searchProductsByName(t){return this.productRepository.findByName(t)}async update(t,e){const i=await this.getProductById(t);this.validateUpdateDTO(e);const r=i.update(e);return this.productRepository.save(r)}async updateProduct(t,e){const r=(await this.getProductById(t)).update(e);return this.productRepository.save(r)}async delete(t,e=!1){if(!await this.productRepository.exists(t))throw S.withId("Product",t);if(this.consumptionRepository&&!e){const r=await this.consumptionRepository.findByProductId(t);if(r.length>0)throw new It(`Cannot delete product with ${r.length} consumption record(s). Use force=true to delete.`,Ct.BUSINESS_RULE_ERROR,{productId:t,consumptionCount:r.length})}await this.productRepository.delete(t)}async deleteProduct(t){if(!await this.productRepository.exists(t))throw S.withId("Product",t);await this.productRepository.delete(t)}async exists(t){return this.productRepository.exists(t)}async count(){return this.productRepository.count()}async getProductCount(){return this.productRepository.count()}validateCreateDTO(t){if(!t.name||t.name.trim().length===0)throw _.required("name","Product");if(!t.category)throw _.required("category","Product");if(!t.type)throw _.required("type","Product");if(!t.unit)throw _.required("unit","Product");if(t.defaultQuantityPerPerson!==void 0&&t.defaultQuantityPerPerson<0)throw _.outOfRange("defaultQuantityPerPerson",0,void 0,t.defaultQuantityPerPerson)}validateUpdateDTO(t){if(t.name!==void 0&&t.name.trim().length===0)throw _.invalidLength("name",1,void 0,0);if(t.defaultQuantityPerPerson!==void 0&&t.defaultQuantityPerPerson!==null&&t.defaultQuantityPerPerson<0)throw _.outOfRange("defaultQuantityPerPerson",0,void 0,t.defaultQuantityPerPerson)}toResponseDTO(t){return{id:t.id,tripId:"",name:t.name,category:t.category,unit:t.unit,defaultQuantityPerPerson:t.defaultQuantityPerPerson??0,notes:t.notes,isEssential:!0,createdAt:t.createdAt,updatedAt:t.updatedAt??t.createdAt}}toWithConsumptionDTO(t,e,i){return{...this.toResponseDTO(t),totalQuantityNeeded:e,totalEstimatedCost:0,consumptionCount:i}}}class Ia{constructor(t,e,i,r){this.consumptionRepository=t,this.participantRepository=e,this.productRepository=i,this.tripRepository=r}async create(t){if(this.validateCreateDTO(t),!await this.participantRepository.exists(t.participantId))throw S.withId("Participant",t.participantId);if(!await this.productRepository.exists(t.productId))throw S.withId("Product",t.productId);if(this.tripRepository){const n=await this.tripRepository.findById(t.tripId);if(n){const c=new Date(t.date);if(c<n.startDate||c>n.endDate)throw _.invalidDateRange("date","trip dates")}}const{Consumption:r}=await vt(async()=>{const{Consumption:n}=await Promise.resolve().then(()=>ie);return{Consumption:n}},void 0),s=r.create({tripId:t.tripId,participantId:t.participantId,productId:t.productId,date:t.date,meal:t.meal,quantity:t.quantity});return this.consumptionRepository.save(s)}async createConsumption(t){if(!await this.participantRepository.exists(t.participantId))throw S.withId("Participant",t.participantId);if(!await this.productRepository.exists(t.productId))throw S.withId("Product",t.productId);const{Consumption:r}=await vt(async()=>{const{Consumption:n}=await Promise.resolve().then(()=>ie);return{Consumption:n}},void 0),s=r.create({tripId:t.tripId,participantId:t.participantId,productId:t.productId,date:t.date,meal:t.meal,quantity:t.quantity});return this.consumptionRepository.save(s)}async createBulk(t,e){const{Consumption:i}=await vt(async()=>{const{Consumption:s}=await Promise.resolve().then(()=>ie);return{Consumption:s}},void 0),r=[];for(const s of e){const n=i.create({tripId:t,participantId:s.participantId,productId:s.productId,date:s.date,meal:s.meal,quantity:s.quantity});r.push(n)}return this.consumptionRepository.saveMany(r)}async getById(t){return this.consumptionRepository.findById(t)}async getConsumptionById(t){const e=await this.consumptionRepository.findById(t);if(!e)throw S.withId("Consumption",t);return e}async getByTripId(t){return this.consumptionRepository.findByTripId(t)}async getConsumptionsByTripId(t){return this.consumptionRepository.findByTripId(t)}async getByTripIdAndDate(t,e){return this.consumptionRepository.findByTripIdAndDate(t,e)}async getConsumptionsByTripIdAndDate(t,e){return this.consumptionRepository.findByTripIdAndDate(t,e)}async getByParticipantId(t){return this.consumptionRepository.findByParticipantId(t)}async getConsumptionsByParticipantId(t){return this.consumptionRepository.findByParticipantId(t)}async getByProductId(t){return this.consumptionRepository.findByProductId(t)}async getConsumptionsByProductId(t){return this.consumptionRepository.findByProductId(t)}async getSummaryByDate(t){const e=await this.consumptionRepository.findByTripId(t),i=new Map;for(const s of e){const n=s.date.toISOString().split("T")[0];i.has(n)||i.set(n,{date:s.date,participants:new Set,count:0,byMeal:new Map});const c=i.get(n);c.participants.add(s.participantId),c.count++,c.byMeal.set(s.meal,(c.byMeal.get(s.meal)||0)+1)}const r=[];for(const[,s]of i)r.push({date:s.date,participantCount:s.participants.size,totalConsumptions:s.count,byMealType:Array.from(s.byMeal.entries()).map(([n,c])=>({mealType:n,count:c}))});return r.sort((s,n)=>s.date.getTime()-n.date.getTime())}async getSummaryByParticipant(t){const e=await this.consumptionRepository.findByTripId(t),i=new Map;for(const s of e){i.has(s.participantId)||i.set(s.participantId,{count:0,products:new Map});const n=i.get(s.participantId);n.count++,n.products.set(s.productId,(n.products.get(s.productId)||0)+s.quantity)}const r=[];for(const[s,n]of i){const c=await this.participantRepository.findById(s),l=[];for(const[d,h]of n.products){const w=await this.productRepository.findById(d);l.push({productId:d,productName:(w==null?void 0:w.name)||"Unknown",totalQuantity:h})}r.push({participantId:s,participantName:(c==null?void 0:c.name)||"Unknown",totalConsumptions:n.count,products:l})}return r}async update(t,e){const i=await this.getConsumptionById(t);this.validateUpdateDTO(e);const r=i.update(e);return this.consumptionRepository.save(r)}async updateConsumption(t,e){const r=(await this.getConsumptionById(t)).update(e);return this.consumptionRepository.save(r)}async delete(t){if(!await this.consumptionRepository.exists(t))throw S.withId("Consumption",t);await this.consumptionRepository.delete(t)}async deleteConsumption(t){if(!await this.consumptionRepository.exists(t))throw S.withId("Consumption",t);await this.consumptionRepository.delete(t)}async deleteByTripId(t){return this.consumptionRepository.deleteByTripId(t)}async deleteConsumptionsByTripId(t){return this.consumptionRepository.deleteByTripId(t)}async deleteByParticipantId(t){return this.consumptionRepository.deleteByParticipantId(t)}async deleteConsumptionsByParticipantId(t){return this.consumptionRepository.deleteByParticipantId(t)}async exists(t){return this.consumptionRepository.exists(t)}async count(){return this.consumptionRepository.count()}async getConsumptionCount(){return this.consumptionRepository.count()}validateCreateDTO(t){if(!t.tripId||t.tripId.trim().length===0)throw _.required("tripId","Consumption");if(!t.participantId||t.participantId.trim().length===0)throw _.required("participantId","Consumption");if(!t.productId||t.productId.trim().length===0)throw _.required("productId","Consumption");if(!t.date)throw _.required("date","Consumption");if(!t.meal)throw _.required("meal","Consumption");if(t.quantity===void 0||t.quantity<0)throw _.outOfRange("quantity",0,void 0,t.quantity)}validateUpdateDTO(t){if(t.quantity!==void 0&&t.quantity<0)throw _.outOfRange("quantity",0,void 0,t.quantity)}toResponseDTO(t,e,i){return{id:t.id,tripId:t.tripId,participantId:t.participantId,participantName:e,productId:t.productId,productName:i,date:t.date,quantity:t.quantity,mealType:t.meal,createdAt:t.createdAt,updatedAt:t.updatedAt??t.createdAt}}}class Na{constructor(t,e,i){this.availabilityRepository=t,this.participantRepository=e,this.tripRepository=i}async setAvailability(t){if(this.validateSetAvailabilityDTO(t),!await this.participantRepository.exists(t.participantId))throw S.withId("Participant",t.participantId);if(this.tripRepository){const s=await this.tripRepository.findById(t.tripId);if(s){const n=new Date(t.date);if(n<s.startDate||n>s.endDate)throw _.invalidDateRange("date","trip dates")}}const i=await this.availabilityRepository.findByParticipantIdAndDate(t.participantId,t.date),{Availability:r}=await vt(async()=>{const{Availability:s}=await Promise.resolve().then(()=>ga);return{Availability:s}},void 0);if(i){const s=i.update({meals:t.meals});return this.availabilityRepository.save(s)}else{const s=r.create({participantId:t.participantId,tripId:t.tripId,date:t.date,meals:t.meals});return this.availabilityRepository.save(s)}}async setAvailabilityRange(t,e,i,r,s){const n=[],c=new Date(i);for(;c<=r;){const l=await this.setAvailability({tripId:t,participantId:e,date:new Date(c),meals:s});n.push(l),c.setDate(c.getDate()+1)}return n}async setAvailabilityForAllParticipants(t,e,i){const r=await this.participantRepository.findByTripId(t),s=[];for(const n of r){const c=await this.setAvailability({tripId:t,participantId:n.id,date:e,meals:i});s.push(c)}return s}async getById(t){return this.availabilityRepository.findById(t)}async getAvailabilityById(t){const e=await this.availabilityRepository.findById(t);if(!e)throw S.withId("Availability",t);return e}async getByTripId(t){return this.availabilityRepository.findByTripId(t)}async getAvailabilitiesByTripId(t){return this.availabilityRepository.findByTripId(t)}async getByTripIdAndDate(t,e){return this.availabilityRepository.findByTripIdAndDate(t,e)}async getAvailabilitiesByTripIdAndDate(t,e){return this.availabilityRepository.findByTripIdAndDate(t,e)}async getByParticipantId(t){return this.availabilityRepository.findByParticipantId(t)}async getAvailabilitiesByParticipantId(t){return this.availabilityRepository.findByParticipantId(t)}async getByParticipantIdAndDate(t,e){return this.availabilityRepository.findByParticipantIdAndDate(t,e)}async getAvailabilityByParticipantIdAndDate(t,e){return this.availabilityRepository.findByParticipantIdAndDate(t,e)}async getSummaryByDate(t){const e=await this.availabilityRepository.findByTripId(t),i=new Map;for(const s of e){const n=s.date.toISOString().split("T")[0];i.has(n)||i.set(n,{date:s.date,participants:[]});const c=await this.participantRepository.findById(s.participantId);i.get(n).participants.push({participantId:s.participantId,participantName:(c==null?void 0:c.name)||"Unknown",meals:this.toMealAvailabilityDTO(s.meals)})}const r=[];for(const[,s]of i){const n=s.participants.filter(d=>d.meals.breakfast).length,c=s.participants.filter(d=>d.meals.lunch).length,l=s.participants.filter(d=>d.meals.dinner).length;r.push({date:s.date,totalAvailable:s.participants.length,breakfastCount:n,lunchCount:c,dinnerCount:l,participants:s.participants})}return r.sort((s,n)=>s.date.getTime()-n.date.getTime())}async getSummaryByParticipant(t){const e=await this.availabilityRepository.findByTripId(t),i=await this.participantRepository.findByTripId(t);let r=1;if(this.tripRepository){const c=await this.tripRepository.findById(t);c&&(r=c.getDurationInDays())}const s=new Map;for(const c of i)s.set(c.id,{name:c.name,dates:[]});for(const c of e){const l=s.get(c.participantId);l&&l.dates.push({date:c.date,meals:this.toMealAvailabilityDTO(c.meals)})}const n=[];for(const[c,l]of s){const d=l.dates.length/r*100;n.push({participantId:c,participantName:l.name,totalDaysAvailable:l.dates.length,availabilityPercentage:Math.round(d*100)/100,dates:l.dates})}return n}async getAvailabilityMatrix(t){const e=await this.availabilityRepository.findByTripId(t),i=await this.participantRepository.findByTripId(t);let r=[];if(this.tripRepository){const d=await this.tripRepository.findById(t);if(d){const h=new Date(d.startDate);for(;h<=d.endDate;)r.push(new Date(h)),h.setDate(h.getDate()+1)}}const s={};for(const d of i){s[d.id]={};for(const h of r){const w=h.toISOString().split("T")[0];s[d.id][w]=null}}for(const d of e){const h=d.date.toISOString().split("T")[0];s[d.participantId]&&(s[d.participantId][h]=this.toMealAvailabilityDTO(d.meals))}let n=0;for(const d of e)d.meals.length>0&&n++;const c=i.length*r.length,l=c>0?Math.round(n/c*100*100)/100:0;return{tripId:t,dates:r,participants:i.map(d=>({id:d.id,name:d.name})),matrix:s,summary:{totalParticipants:i.length,totalDays:r.length,averageAvailability:l}}}async getParticipantsAvailableForMeal(t,e,i){return(await this.getByTripIdAndDate(t,e)).filter(s=>s.meals.includes(i)).map(s=>s.participantId)}async countAvailableByMeal(t,e){const i=await this.getByTripIdAndDate(t,e);return{breakfast:i.filter(r=>r.meals.includes("breakfast")).length,lunch:i.filter(r=>r.meals.includes("lunch")).length,dinner:i.filter(r=>r.meals.includes("dinner")).length,snack:i.filter(r=>r.meals.includes("snack")).length}}async delete(t){if(!await this.availabilityRepository.exists(t))throw S.withId("Availability",t);await this.availabilityRepository.delete(t)}async deleteAvailability(t){if(!await this.availabilityRepository.exists(t))throw S.withId("Availability",t);await this.availabilityRepository.delete(t)}async deleteByParticipantId(t){return this.availabilityRepository.deleteByParticipantId(t)}async deleteAvailabilitiesByParticipantId(t){return this.availabilityRepository.deleteByParticipantId(t)}async deleteByTripId(t){return this.availabilityRepository.deleteByTripId(t)}async deleteAvailabilitiesByTripId(t){return this.availabilityRepository.deleteByTripId(t)}async exists(t){return this.availabilityRepository.exists(t)}async count(){return this.availabilityRepository.count()}validateSetAvailabilityDTO(t){if(!t.tripId||t.tripId.trim().length===0)throw _.required("tripId","Availability");if(!t.participantId||t.participantId.trim().length===0)throw _.required("participantId","Availability");if(!t.date)throw _.required("date","Availability");if(!Array.isArray(t.meals))throw _.invalidFormat("meals","array of meal types")}toMealAvailabilityDTO(t){return{breakfast:t.includes("breakfast"),lunch:t.includes("lunch"),dinner:t.includes("dinner")}}toResponseDTO(t,e){return{id:t.id,tripId:t.tripId,participantId:t.participantId,participantName:e,date:t.date,meals:this.toMealAvailabilityDTO(t.meals),createdAt:t.createdAt,updatedAt:t.updatedAt??t.createdAt}}}class Ca{constructor(t,e,i,r,s){this.consumptionRepository=t,this.productRepository=e,this.availabilityRepository=i,this.tripRepository=r,this.participantRepository=s}async generate(t,e){let i=null,r="Unknown Trip",s=new Date,n=new Date,c=1;if(this.tripRepository){if(i=await this.tripRepository.findById(t),!i)throw S.withId("Trip",t);r=i.name,s=i.startDate,n=i.endDate,c=i.getDurationInDays()}let l=0;this.participantRepository&&(l=await this.participantRepository.countByTripId(t));const d=await this.consumptionRepository.findByTripId(t),h=await this.availabilityRepository.findByTripId(t),w=new Map;for(const A of d){const p=A.date.toISOString().split("T")[0];w.has(A.productId)||w.set(A.productId,{quantity:0,byDate:new Map});const v=w.get(A.productId);if(v.quantity+=A.quantity,!v.byDate.has(p)){const x=h.filter(M=>M.date.toISOString().split("T")[0]===p);v.byDate.set(p,{quantity:0,participantCount:x.length})}const T=v.byDate.get(p);T.quantity+=A.quantity}const g=[],b=await this.productRepository.findAll(),I=new Map(b.map(A=>[A.id,A]));for(const[A,p]of w){const v=I.get(A);if(!v||e!=null&&e.essentialOnly&&!v.defaultQuantityPerPerson||e!=null&&e.categories&&!e.categories.includes(v.category))continue;const T=(e==null?void 0:e.quantityMultiplier)??1,x=Math.ceil(p.quantity*T),M=[];for(const[ct,st]of p.byDate)M.push({date:new Date(ct),quantity:Math.ceil(st.quantity*T),participantCount:st.participantCount});g.push({productId:v.id,productName:v.name,category:v.category,totalQuantity:x,unit:v.unit,isEssential:!!v.defaultQuantityPerPerson,notes:v.notes,byDate:M.sort((ct,st)=>ct.date.getTime()-st.date.getTime())})}g.sort((A,p)=>A.category!==p.category?A.category.localeCompare(p.category):A.productName.localeCompare(p.productName));const u=[],j=new Map;for(const A of g)j.has(A.category)||j.set(A.category,[]),j.get(A.category).push(A);for(const[A,p]of j){const v=p.reduce((T,x)=>T+(x.totalEstimatedCost??0),0);u.push({category:A,categoryDisplayName:this.getCategoryDisplayName(A),items:p,categoryTotalCost:v,itemCount:p.length})}const D=g.filter(A=>A.isEssential).length,L=g.filter(A=>!A.isEssential).length,$=g.reduce((A,p)=>A+(p.totalEstimatedCost??0),0);return{tripId:t,tripName:r,startDate:s,endDate:n,totalDays:c,participantCount:l,items:g,byCategory:u,totalItems:g.length,totalEstimatedCost:$,essentialItemsCount:D,optionalItemsCount:L,generatedAt:new Date}}async generateShoppingList(t){const e=await this.consumptionRepository.findByTripId(t),i=new Map;for(const s of e){const n=i.get(s.productId)||0;i.set(s.productId,n+s.quantity)}const r=[];for(const[s,n]of i){const c=await this.productRepository.findById(s);c&&r.push({product:c,totalQuantity:n,unit:c.unit})}return r.sort((s,n)=>s.product.category!==n.product.category?s.product.category.localeCompare(n.product.category):s.product.name.localeCompare(n.product.name)),{tripId:t,items:r,generatedAt:new Date}}async getConsumptionSummaryByProduct(t){const e=await this.consumptionRepository.findByTripId(t),i=new Map;for(const s of e){const n=i.get(s.productId)||{quantity:0,count:0};i.set(s.productId,{quantity:n.quantity+s.quantity,count:n.count+1})}const r=[];for(const[s,n]of i){const c=await this.productRepository.findById(s);c&&r.push({productId:s,productName:c.name,totalQuantity:n.quantity,unit:c.unit,consumptionCount:n.count})}return r.sort((s,n)=>n.totalQuantity-s.totalQuantity),r}async calculateEstimatedQuantities(t,e){const i=await this.availabilityRepository.findByTripIdAndDate(t,e),r=await this.productRepository.findAll(),s=new Map,n=new Map;for(const l of i)for(const d of l.meals){const h=n.get(d)||0;n.set(d,h+1)}let c=0;for(const l of n.values())c+=l;for(const l of r)if(l.defaultQuantityPerPerson){const d=l.defaultQuantityPerPerson*c;s.set(l.id,d)}return s}async calculateTotalEstimatedQuantities(t){const e=await this.availabilityRepository.findByTripId(t),i=await this.productRepository.findAll(),r=new Map;let s=0;for(const n of e)s+=n.meals.length;for(const n of i)if(n.defaultQuantityPerPerson){const c=n.defaultQuantityPerPerson*s;r.set(n.id,c)}return r}async getConsumptionVariance(t){const e=await this.consumptionRepository.findByTripId(t),i=await this.productRepository.findAll(),s=(await this.availabilityRepository.findByTripId(t)).reduce((l,d)=>l+d.meals.length,0),n=new Map;for(const l of e){const d=n.get(l.productId)||0;n.set(l.productId,d+l.quantity)}const c=[];for(const l of i)if(l.defaultQuantityPerPerson){const d=l.defaultQuantityPerPerson*s,h=n.get(l.id)||0,w=h-d,g=d>0?Math.round(w/d*100*100)/100:0;c.push({productId:l.id,productName:l.name,estimated:d,actual:h,variance:w,variancePercentage:g,unit:l.unit})}return c.sort((l,d)=>Math.abs(d.variance)-Math.abs(l.variance)),c}async getShoppingSuggestions(t){const e=await this.getConsumptionVariance(t),i=[];for(const r of e)if(r.variance>0){const s=r.variancePercentage>50?"high":r.variancePercentage>20?"medium":"low";i.push({productId:r.productId,productName:r.productName,suggestion:`Consider increasing stock by ${Math.ceil(r.variance)} ${r.unit}`,priority:s,suggestedQuantity:Math.ceil(r.estimated*1.2),unit:r.unit})}else r.variance<-r.estimated*.3&&i.push({productId:r.productId,productName:r.productName,suggestion:`Consider reducing stock - ${Math.abs(r.variance)} ${r.unit} unused`,priority:"low",suggestedQuantity:Math.ceil(r.actual*1.1),unit:r.unit});return i}getCategoryDisplayName(t){return{food:"Food",beverage:"Beverages",other:"Other"}[t]||t}}const qt=new Vt,Pa=o=>Ht.fromPersistence(o),Da=o=>Gt.fromPersistence(o),Aa=o=>Xt.fromPersistence(o),Ra=o=>Yt.fromPersistence(o),Ta=o=>ot.fromPersistence(o),Re=new Ke(qt,Pa),ne=new Ze(qt,Da),oe=new ta(qt,Aa),Te=new ea(qt,Ra),Ee=new aa(qt,Ta),Ea=new _a(Re),Ba=new ba(ne,Re),La=new ja(oe),ka=new Ia(Te,ne,oe),Sa=new Na(Ee,ne),$a=new Ca(Te,oe,Ee),Ma={tripService:Ea,participantService:Ba,productService:La,consumptionService:ka,availabilityService:Sa,shoppingService:$a},Be=y.createContext(null),Oa=({children:o})=>{const t=y.useMemo(()=>Ma,[]);return a.jsx(Be.Provider,{value:t,children:o})},ce=()=>{const o=y.useContext(Be);if(!o)throw new Error("useServices must be used within a ServiceProvider");return o},qa="_header_9ro8n_2",Fa="_container_9ro8n_10",Wa="_left_9ro8n_21",za="_menuButton_9ro8n_27",Va="_logo_9ro8n_47",Qa="_logoText_9ro8n_62",Ua="_tripBadge_9ro8n_67",Ha="_nav_9ro8n_83",Ga="_navLink_9ro8n_89",Xa="_active_9ro8n_105",Ya="_right_9ro8n_111",Ja="_iconButton_9ro8n_117",tt={header:qa,container:Fa,left:Wa,menuButton:za,logo:Va,logoText:Qa,tripBadge:Ua,nav:Ha,navLink:Ga,active:Xa,right:Ya,iconButton:Ja},Ka=({tripName:o,showNav:t=!0,onToggleSidebar:e})=>{const i=ze(),r=s=>i.pathname===s;return a.jsx("header",{className:tt.header,children:a.jsxs("div",{className:tt.container,children:[a.jsxs("div",{className:tt.left,children:[e&&a.jsx("button",{type:"button",className:tt.menuButton,onClick:e,"aria-label":"Abrir menu",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 12h18M3 6h18M3 18h18"})})}),a.jsxs(it,{to:"/",className:tt.logo,children:[a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 3h18v18H3zM12 8v8m-4-4h8"})}),a.jsx("span",{className:tt.logoText,children:"TripFood"})]}),o&&a.jsxs("div",{className:tt.tripBadge,children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})}),a.jsx("span",{children:o})]})]}),t&&a.jsxs("nav",{className:tt.nav,"aria-label":"Navegacion principal",children:[a.jsx(it,{to:"/",className:`${tt.navLink} ${r("/")?tt.active:""}`,children:"Inicio"}),a.jsx(it,{to:"/trips",className:`${tt.navLink} ${i.pathname.startsWith("/trips")?tt.active:""}`,children:"Viajes"})]}),a.jsx("div",{className:tt.right,children:a.jsx("button",{type:"button",className:tt.iconButton,"aria-label":"Configuracion",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})})})]})})},Za="_overlay_x3rsb_2",ti="_sidebar_x3rsb_10",ei="_header_x3rsb_25",ai="_title_x3rsb_33",ii="_closeButton_x3rsb_40",ri="_nav_x3rsb_60",si="_navItem_x3rsb_66",ni="_active_x3rsb_86",oi="_navIcon_x3rsb_91",ci="_navLabel_x3rsb_103",li="_footer_x3rsb_108",di="_backLink_x3rsb_113",pi="_open_x3rsb_144",nt={overlay:Za,sidebar:ti,header:ei,title:ai,closeButton:ii,nav:ri,navItem:si,active:ni,navIcon:oi,navLabel:ci,footer:li,backLink:di,open:pi},ui=({isOpen:o,onClose:t})=>{const{tripId:e}=Bt(),i=[{path:`/trips/${e}`,label:"Dashboard",icon:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})},{path:`/trips/${e}/participants`,label:"Participantes",icon:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]})},{path:`/trips/${e}/products`,label:"Productos",icon:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"})})},{path:`/trips/${e}/availability`,label:"Disponibilidad",icon:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 11l3 3L22 4"}),a.jsx("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"})]})},{path:`/trips/${e}/shopping`,label:"Lista de Compras",icon:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"9",cy:"21",r:"1"}),a.jsx("circle",{cx:"20",cy:"21",r:"1"}),a.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"})]})}];return a.jsxs(a.Fragment,{children:[o&&a.jsx("div",{className:nt.overlay,onClick:t,"aria-hidden":"true"}),a.jsxs("aside",{className:`${nt.sidebar} ${o?nt.open:""}`,"aria-label":"Menu de navegacion del viaje",children:[a.jsxs("div",{className:nt.header,children:[a.jsx("h2",{className:nt.title,children:"Menu"}),a.jsx("button",{type:"button",className:nt.closeButton,onClick:t,"aria-label":"Cerrar menu",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("nav",{className:nt.nav,children:i.map(r=>a.jsxs(ue,{to:r.path,end:r.path===`/trips/${e}`,className:({isActive:s})=>`${nt.navItem} ${s?nt.active:""}`,onClick:t,children:[a.jsx("span",{className:nt.navIcon,children:r.icon}),a.jsx("span",{className:nt.navLabel,children:r.label})]},r.path))}),a.jsx("div",{className:nt.footer,children:a.jsxs(ue,{to:"/trips",className:nt.backLink,onClick:t,children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Volver a Viajes"]})})]})]})},hi="_layout_21p42_2",mi="_body_21p42_9",yi="_main_21p42_15",fi="_withSidebar_21p42_22",vi="_content_21p42_26",$t={layout:hi,body:mi,main:yi,withSidebar:fi,content:vi},X=({children:o,tripName:t,showSidebar:e=!1,showNav:i=!0})=>{const[r,s]=y.useState(!1),n=y.useCallback(()=>{s(l=>!l)},[]),c=y.useCallback(()=>{s(!1)},[]);return a.jsxs("div",{className:$t.layout,children:[a.jsx(Ka,{tripName:t,showNav:i,onToggleSidebar:e?n:void 0}),a.jsxs("div",{className:$t.body,children:[e&&a.jsx(ui,{isOpen:r,onClose:c}),a.jsx("main",{className:`${$t.main} ${e?$t.withSidebar:""}`,children:a.jsx("div",{className:$t.content,children:o})})]})]})},gi="_button_1ow04_2",xi="_primary_1ow04_30",wi="_secondary_1ow04_46",_i="_danger_1ow04_61",bi="_ghost_1ow04_77",ji="_sm_1ow04_92",Ii="_md_1ow04_97",Ni="_lg_1ow04_102",Ci="_fullWidth_1ow04_108",Pi="_loading_1ow04_113",Di="_content_1ow04_118",Ai="_spinner_1ow04_122",Ri="_spin_1ow04_122",Ti="_icon_1ow04_148",gt={button:gi,primary:xi,secondary:wi,danger:_i,ghost:bi,sm:ji,md:Ii,lg:Ni,fullWidth:Ci,loading:Pi,content:Di,spinner:Ai,spin:Ri,icon:Ti},Q=({children:o,variant:t="primary",size:e="md",isLoading:i=!1,leftIcon:r,rightIcon:s,fullWidth:n=!1,disabled:c,className:l,type:d="button",...h})=>{const w=[gt.button,gt[t],gt[e],n?gt.fullWidth:"",i?gt.loading:"",l??""].filter(Boolean).join(" ");return a.jsxs("button",{type:d,className:w,disabled:c||i,"aria-busy":i,...h,children:[i&&a.jsx("span",{className:gt.spinner,"aria-hidden":"true"}),!i&&r&&a.jsx("span",{className:gt.icon,"aria-hidden":"true",children:r}),a.jsx("span",{className:gt.content,children:o}),!i&&s&&a.jsx("span",{className:gt.icon,"aria-hidden":"true",children:s})]})},Ei="_overlay_1ver5_2",Bi="_fadeIn_1ver5_1",Li="_modal_1ver5_23",ki="_slideIn_1ver5_1",Si="_sm_1ver5_46",$i="_md_1ver5_51",Mi="_lg_1ver5_56",Oi="_xl_1ver5_61",qi="_header_1ver5_67",Fi="_title_1ver5_76",Wi="_closeButton_1ver5_83",zi="_body_1ver5_108",Vi="_footer_1ver5_115",wt={overlay:Ei,fadeIn:Bi,modal:Li,slideIn:ki,sm:Si,md:$i,lg:Mi,xl:Oi,header:qi,title:Fi,closeButton:Wi,body:zi,footer:Vi},Et=({isOpen:o,onClose:t,title:e,children:i,footer:r,size:s="md",closeOnOverlayClick:n=!0,closeOnEscape:c=!0})=>{const l=y.useRef(null),d=y.useRef(null),h=y.useCallback(b=>{c&&b.key==="Escape"&&t()},[c,t]),w=y.useCallback(b=>{n&&b.target===b.currentTarget&&t()},[n,t]);if(y.useEffect(()=>{var b,I;return o?(d.current=document.activeElement,(b=l.current)==null||b.focus(),document.body.style.overflow="hidden"):(document.body.style.overflow="",(I=d.current)==null||I.focus()),()=>{document.body.style.overflow=""}},[o]),!o)return null;const g=a.jsx("div",{className:wt.overlay,onClick:w,onKeyDown:h,role:"presentation",children:a.jsxs("div",{ref:l,className:`${wt.modal} ${wt[s]}`,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",tabIndex:-1,children:[a.jsxs("div",{className:wt.header,children:[a.jsx("h2",{id:"modal-title",className:wt.title,children:e}),a.jsx("button",{type:"button",className:wt.closeButton,onClick:t,"aria-label":"Cerrar modal",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:wt.body,children:i}),r&&a.jsx("div",{className:wt.footer,children:r})]})});return Ve.createPortal(g,document.body)},Qi="_card_x6pxi_2",Ui="_outlined_x6pxi_15",Hi="_elevated_x6pxi_20",Gi="_body_x6pxi_25",Xi="_header_x6pxi_42",Yi="_headerText_x6pxi_50",Ji="_title_x6pxi_55",Ki="_subtitle_x6pxi_63",Zi="_headerActions_x6pxi_70",tr="_footer_x6pxi_84",er="_interactive_x6pxi_91",ut={card:Qi,default:"_default_x6pxi_11",outlined:Ui,elevated:Hi,"padding-none":"_padding-none_x6pxi_25",body:Gi,"padding-sm":"_padding-sm_x6pxi_29","padding-md":"_padding-md_x6pxi_33","padding-lg":"_padding-lg_x6pxi_37",header:Xi,headerText:Yi,title:Ji,subtitle:Ki,headerActions:Zi,footer:tr,interactive:er},V=({title:o,subtitle:t,headerActions:e,footer:i,variant:r="default",padding:s="md",interactive:n=!1,children:c,className:l,onClick:d,...h})=>{const w=[ut.card,ut[r],ut[`padding-${s}`],n?ut.interactive:"",l??""].filter(Boolean).join(" "),g=o||t||e;return a.jsxs("div",{className:w,onClick:d,role:n?"button":void 0,tabIndex:n?0:void 0,onKeyDown:n?b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),d==null||d(b))}:void 0,...h,children:[g&&a.jsxs("div",{className:ut.header,children:[a.jsxs("div",{className:ut.headerText,children:[o&&a.jsx("h3",{className:ut.title,children:o}),t&&a.jsx("p",{className:ut.subtitle,children:t})]}),e&&a.jsx("div",{className:ut.headerActions,children:e})]}),a.jsx("div",{className:ut.body,children:c}),i&&a.jsx("div",{className:ut.footer,children:i})]})},ar="_container_xvbs2_2",ir="_fullWidth_xvbs2_8",rr="_label_xvbs2_13",sr="_required_xvbs2_19",nr="_inputWrapper_xvbs2_24",or="_error_xvbs2_39",cr="_disabled_xvbs2_47",lr="_sm_xvbs2_53",dr="_input_xvbs2_24",pr="_md_xvbs2_62",ur="_lg_xvbs2_71",hr="_addon_xvbs2_101",mr="_hasLeftAddon_xvbs2_109",yr="_hasRightAddon_xvbs2_113",fr="_helperText_xvbs2_118",vr="_errorText_xvbs2_124",Y={container:ar,fullWidth:ir,label:rr,required:sr,inputWrapper:nr,error:or,disabled:cr,sm:lr,input:dr,md:pr,lg:ur,addon:hr,hasLeftAddon:mr,hasRightAddon:yr,helperText:fr,errorText:vr},rt=y.forwardRef(({label:o,helperText:t,error:e,size:i="md",leftAddon:r,rightAddon:s,required:n=!1,fullWidth:c=!1,className:l,id:d,disabled:h,...w},g)=>{const b=d||`input-${Math.random().toString(36).substr(2,9)}`,I=!!e,u=[Y.container,c?Y.fullWidth:"",l??""].filter(Boolean).join(" "),j=[Y.inputWrapper,Y[i],I?Y.error:"",h?Y.disabled:"",r?Y.hasLeftAddon:"",s?Y.hasRightAddon:""].filter(Boolean).join(" ");return a.jsxs("div",{className:u,children:[o&&a.jsxs("label",{htmlFor:b,className:Y.label,children:[o,n&&a.jsx("span",{className:Y.required,"aria-hidden":"true",children:" *"})]}),a.jsxs("div",{className:j,children:[r&&a.jsx("span",{className:Y.addon,"aria-hidden":"true",children:r}),a.jsx("input",{ref:g,id:b,className:Y.input,disabled:h,"aria-invalid":I,"aria-describedby":e?`${b}-error`:t?`${b}-helper`:void 0,required:n,...w}),s&&a.jsx("span",{className:Y.addon,"aria-hidden":"true",children:s})]}),e&&a.jsx("p",{id:`${b}-error`,className:Y.errorText,role:"alert",children:e}),!e&&t&&a.jsx("p",{id:`${b}-helper`,className:Y.helperText,children:t})]})});rt.displayName="Input";const gr="_container_mu5gb_2",xr="_fullWidth_mu5gb_8",wr="_label_mu5gb_13",_r="_required_mu5gb_19",br="_selectWrapper_mu5gb_24",jr="_error_mu5gb_39",Ir="_disabled_mu5gb_47",Nr="_sm_mu5gb_53",Cr="_select_mu5gb_24",Pr="_md_mu5gb_62",Dr="_lg_mu5gb_71",Ar="_icon_mu5gb_109",Rr="_hasLeftIcon_mu5gb_119",Tr="_chevron_mu5gb_124",Er="_helperText_mu5gb_135",Br="_errorText_mu5gb_141",et={container:gr,fullWidth:xr,label:wr,required:_r,selectWrapper:br,error:jr,disabled:Ir,sm:Nr,select:Cr,md:Pr,lg:Dr,icon:Ar,hasLeftIcon:Rr,chevron:Tr,helperText:Er,errorText:Br},se=y.forwardRef(({label:o,options:t,placeholder:e,helperText:i,error:r,size:s="md",required:n=!1,fullWidth:c=!1,leftIcon:l,className:d,id:h,disabled:w,...g},b)=>{const I=h||`select-${Math.random().toString(36).substr(2,9)}`,u=!!r,j=[et.container,c?et.fullWidth:"",d??""].filter(Boolean).join(" "),D=[et.selectWrapper,et[s],u?et.error:"",w?et.disabled:"",l?et.hasLeftIcon:""].filter(Boolean).join(" ");return a.jsxs("div",{className:j,children:[o&&a.jsxs("label",{htmlFor:I,className:et.label,children:[o,n&&a.jsx("span",{className:et.required,"aria-hidden":"true",children:" *"})]}),a.jsxs("div",{className:D,children:[l&&a.jsx("span",{className:et.icon,"aria-hidden":"true",children:l}),a.jsxs("select",{ref:b,id:I,className:et.select,disabled:w,"aria-invalid":u,"aria-describedby":r?`${I}-error`:i?`${I}-helper`:void 0,required:n,...g,children:[e&&a.jsx("option",{value:"",disabled:!0,children:e}),t.map(L=>a.jsx("option",{value:L.value,disabled:L.disabled,children:L.label},L.value))]}),a.jsx("span",{className:et.chevron,"aria-hidden":"true",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),r&&a.jsx("p",{id:`${I}-error`,className:et.errorText,role:"alert",children:r}),!r&&i&&a.jsx("p",{id:`${I}-helper`,className:et.helperText,children:i})]})});se.displayName="Select";const Lr="_wrapper_1ua89_2",kr="_table_1ua89_9",Sr="_thead_1ua89_16",$r="_th_1ua89_16",Mr="_sortButton_1ua89_45",Or="_sortIcon_1ua89_66",qr="_tbody_1ua89_72",Fr="_tr_1ua89_76",Wr="_clickable_1ua89_89",zr="_selected_1ua89_93",Vr="_td_1ua89_101",Qr="_checkboxCell_1ua89_108",Ur="_emptyCell_1ua89_122",Hr="_striped_1ua89_129",Gr="_compact_1ua89_138",Xr="_loadingContainer_1ua89_147",Yr="_loadingSpinner_1ua89_157",Jr="_spin_1ua89_1",W={wrapper:Lr,table:kr,thead:Sr,th:$r,"align-left":"_align-left_1ua89_32","align-center":"_align-center_1ua89_36","align-right":"_align-right_1ua89_40",sortButton:Mr,sortIcon:Or,tbody:qr,tr:Fr,clickable:Wr,selected:zr,td:Vr,checkboxCell:Qr,emptyCell:Ur,striped:Hr,compact:Gr,loadingContainer:Xr,loadingSpinner:Yr,spin:Jr};function Le({data:o,columns:t,getRowKey:e,isLoading:i=!1,emptyMessage:r="No hay datos disponibles",sortKey:s,sortDirection:n,onSort:c,onRowClick:l,selectedKeys:d,onSelectRow:h,onSelectAll:w,selectable:g=!1,striped:b=!1,compact:I=!1}){const u=o.length>0&&(d==null?void 0:d.size)===o.length,j=d&&d.size>0&&d.size<o.length,D=[W.table,b?W.striped:"",I?W.compact:""].filter(Boolean).join(" "),L=p=>{c&&c(p)},$=()=>{w&&w(!u)},A=p=>{h&&d&&h(p,!d.has(p))};return i?a.jsxs("div",{className:W.loadingContainer,children:[a.jsx("div",{className:W.loadingSpinner}),a.jsx("p",{children:"Cargando datos..."})]}):a.jsx("div",{className:W.wrapper,children:a.jsxs("table",{className:D,children:[a.jsx("thead",{className:W.thead,children:a.jsxs("tr",{children:[g&&a.jsx("th",{className:W.checkboxCell,children:a.jsx("input",{type:"checkbox",checked:u,ref:p=>{p&&(p.indeterminate=j??!1)},onChange:$,"aria-label":"Seleccionar todos"})}),t.map(p=>a.jsx("th",{className:`${W.th} ${W[`align-${p.align||"left"}`]}`,style:{width:p.width},children:p.sortable&&c?a.jsxs("button",{type:"button",className:W.sortButton,onClick:()=>L(p.key),"aria-label":`Ordenar por ${p.header}`,children:[p.header,a.jsx("span",{className:W.sortIcon,children:s===p.key?n==="asc"?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 9l6 6 6-6"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.3",children:a.jsx("path",{d:"M7 15l5 5 5-5M7 9l5-5 5 5"})})})]}):p.header},p.key))]})}),a.jsx("tbody",{className:W.tbody,children:o.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:t.length+(g?1:0),className:W.emptyCell,children:r})}):o.map((p,v)=>{const T=e(p,v),x=d==null?void 0:d.has(T);return a.jsxs("tr",{className:`${W.tr} ${x?W.selected:""} ${l?W.clickable:""}`,onClick:l?()=>l(p,v):void 0,children:[g&&a.jsx("td",{className:W.checkboxCell,children:a.jsx("input",{type:"checkbox",checked:x,onChange:()=>A(T),onClick:M=>M.stopPropagation(),"aria-label":`Seleccionar fila ${v+1}`})}),t.map(M=>a.jsx("td",{className:`${W.td} ${W[`align-${M.align||"left"}`]}`,children:M.render(p,v)},M.key))]},T)})})]})})}const Kr="_container_38p1t_2",Zr="_overlay_38p1t_11",ts="_fullscreen_38p1t_18",es="_spinner_38p1t_26",as="_rotate_38p1t_1",is="_sm_38p1t_36",rs="_md_38p1t_41",ss="_lg_38p1t_46",ns="_track_38p1t_52",os="_progress_38p1t_57",cs="_dash_38p1t_1",ls="_message_38p1t_64",_t={container:Kr,overlay:Zr,fullscreen:ts,spinner:es,rotate:as,sm:is,md:rs,lg:ss,track:ns,progress:os,dash:cs,message:ls},Pt=({size:o="md",message:t="Cargando...",overlay:e=!1,fullscreen:i=!1})=>{const r=[_t.container,e?_t.overlay:"",i?_t.fullscreen:""].filter(Boolean).join(" ");return a.jsxs("div",{className:r,role:"status","aria-live":"polite",children:[a.jsx("div",{className:`${_t.spinner} ${_t[o]}`,"aria-hidden":"true",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{className:_t.track,cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3"}),a.jsx("circle",{className:_t.progress,cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]})}),t&&a.jsx("p",{className:_t.message,children:t}),a.jsx("span",{className:"sr-only",children:t})]})},ds="_container_dx1es_2",ps="_sm_dx1es_12",us="_iconWrapper_dx1es_16",hs="_title_dx1es_26",ms="_description_dx1es_30",ys="_md_dx1es_34",fs="_lg_dx1es_48",vs="_action_dx1es_97",Rt={container:ds,sm:ps,iconWrapper:us,title:hs,description:ms,md:ys,lg:fs,action:vs},Dt=({icon:o,title:t,description:e,action:i,size:r="md"})=>{const s=a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})});return a.jsxs("div",{className:`${Rt.container} ${Rt[r]}`,role:"status",children:[a.jsx("div",{className:Rt.iconWrapper,"aria-hidden":"true",children:o||s}),a.jsx("h3",{className:Rt.title,children:t}),e&&a.jsx("p",{className:Rt.description,children:e}),i&&a.jsx("div",{className:Rt.action,children:i})]})},gs="_container_ut5yo_4",xs="_card_ut5yo_13",ws="_fullpage_ut5yo_20",_s="_iconWrapper_ut5yo_28",bs="_title_ut5yo_41",js="_message_ut5yo_49",Is="_actions_ut5yo_58",Ns="_retryButton_ut5yo_66",Cs="_inline_ut5yo_91",Ps="_inlineIcon_ut5yo_102",Ds="_inlineMessage_ut5yo_108",As="_inlineRetry_ut5yo_113",ht={container:gs,card:xs,fullpage:ws,iconWrapper:_s,title:bs,message:js,actions:Is,retryButton:Ns,inline:Cs,inlineIcon:Ps,inlineMessage:Ds,inlineRetry:As},Lt=({title:o="Error",message:t,onRetry:e,retryText:i="Reintentar",icon:r,action:s,variant:n="card"})=>{const c=a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 8v4m0 4h.01"})]});return n==="inline"?a.jsxs("div",{className:ht.inline,role:"alert",children:[a.jsx("span",{className:ht.inlineIcon,"aria-hidden":"true",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 8v4m0 4h.01"})]})}),a.jsx("span",{className:ht.inlineMessage,children:t}),e&&a.jsx("button",{type:"button",className:ht.inlineRetry,onClick:e,children:i})]}):a.jsxs("div",{className:`${ht.container} ${ht[n]}`,role:"alert",children:[a.jsx("div",{className:ht.iconWrapper,"aria-hidden":"true",children:r||c}),a.jsx("h3",{className:ht.title,children:o}),a.jsx("p",{className:ht.message,children:t}),a.jsxs("div",{className:ht.actions,children:[e&&a.jsxs("button",{type:"button",className:ht.retryButton,onClick:e,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 4v6h6M23 20v-6h-6"}),a.jsx("path",{d:"M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"})]}),i]}),s]})]})},Rs="_content_198wn_2",Ts="_iconWrapper_198wn_11",Es="_danger_198wn_20",Bs="_warning_198wn_25",Ls="_info_198wn_30",ks="_message_198wn_36",zt={content:Rs,iconWrapper:Ts,danger:Es,warning:Bs,info:Ls,message:ks},le=({isOpen:o,onClose:t,onConfirm:e,title:i,message:r,confirmText:s="Confirmar",cancelText:n="Cancelar",variant:c="danger",isLoading:l=!1,icon:d})=>{const h={danger:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0zM12 9v4m0 4h.01"})}),warning:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 8v4m0 4h.01"})]}),info:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4m0-4h.01"})]})},w=c==="danger"?"danger":"primary",g=a.jsxs(a.Fragment,{children:[a.jsx(Q,{variant:"secondary",onClick:t,disabled:l,children:n}),a.jsx(Q,{variant:w,onClick:e,isLoading:l,children:s})]});return a.jsx(Et,{isOpen:o,onClose:t,title:i,footer:g,size:"sm",closeOnOverlayClick:!l,closeOnEscape:!l,children:a.jsxs("div",{className:zt.content,children:[a.jsx("div",{className:`${zt.iconWrapper} ${zt[c]}`,"aria-hidden":"true",children:d||h[c]}),a.jsx("div",{className:zt.message,children:typeof r=="string"?a.jsx("p",{children:r}):r})]})})};function jt(o={}){const{initialOpen:t=!1,onOpen:e,onClose:i}=o,[r,s]=y.useState(t),n=y.useCallback(()=>{s(!0),e==null||e()},[e]),c=y.useCallback(()=>{s(!1),i==null||i()},[i]),l=y.useCallback(()=>{s(h=>{const w=!h;return w?e==null||e():i==null||i(),w})},[e,i]),d=y.useMemo(()=>({isOpen:r,onClose:c}),[r,c]);return{isOpen:r,open:n,close:c,toggle:l,modalProps:d}}function de(){const[o,t]=y.useState([]),[e,i]=y.useState(!0),[r,s]=y.useState(null),{tripService:n}=ce(),c=y.useCallback(()=>{s(null)},[]),l=y.useCallback(async()=>{try{i(!0),s(null);const b=await n.getAllTripsOrderedByStartDate();t(b)}catch(b){const I=b instanceof Error?b:new Error("Error al cargar los viajes");s(I)}finally{i(!1)}},[n]),d=y.useCallback(async b=>{try{i(!0),s(null);const I=await n.createTrip(b);return t(u=>[...u,I]),I}catch(I){const u=I instanceof Error?I:new Error("Error al crear el viaje");throw s(u),u}finally{i(!1)}},[n]),h=y.useCallback(async(b,I)=>{try{i(!0),s(null);const u=await n.updateTrip(b,I);return t(j=>j.map(D=>D.id===b?u:D)),u}catch(u){const j=u instanceof Error?u:new Error("Error al actualizar el viaje");throw s(j),j}finally{i(!1)}},[n]),w=y.useCallback(async b=>{try{i(!0),s(null),await n.deleteTrip(b),t(I=>I.filter(u=>u.id!==b))}catch(I){const u=I instanceof Error?I:new Error("Error al eliminar el viaje");throw s(u),u}finally{i(!1)}},[n]),g=y.useCallback(async b=>{try{return s(null),await n.getTripById(b)}catch(I){const u=I instanceof Error?I:new Error("Error al obtener el viaje");throw s(u),u}},[n]);return y.useEffect(()=>{l()},[l]),{trips:o,isLoading:e,error:r,fetchTrips:l,createTrip:d,updateTrip:h,deleteTrip:w,getTripById:g,clearError:c,refetch:l}}function Jt(o){const[t,e]=y.useState([]),[i,r]=y.useState(!0),[s,n]=y.useState(null),{participantService:c}=ce(),l=y.useCallback(()=>{n(null)},[]),d=y.useCallback(async()=>{if(!o){e([]),r(!1);return}try{r(!0),n(null);const u=await c.getParticipantsByTripId(o);e(u)}catch(u){const j=u instanceof Error?u:new Error("Error al cargar los participantes");n(j)}finally{r(!1)}},[o,c]),h=y.useCallback(async u=>{try{r(!0),n(null);const j=await c.createParticipant({...u,tripId:o});return e(D=>[...D,j]),j}catch(j){const D=j instanceof Error?j:new Error("Error al crear el participante");throw n(D),D}finally{r(!1)}},[o,c]),w=y.useCallback(async(u,j)=>{try{r(!0),n(null);const D=await c.updateParticipant(u,j);return e(L=>L.map($=>$.id===u?D:$)),D}catch(D){const L=D instanceof Error?D:new Error("Error al actualizar el participante");throw n(L),L}finally{r(!1)}},[c]),g=y.useCallback(async u=>{try{r(!0),n(null),await c.deleteParticipant(u),e(j=>j.filter(D=>D.id!==u))}catch(j){const D=j instanceof Error?j:new Error("Error al eliminar el participante");throw n(D),D}finally{r(!1)}},[c]),b=y.useCallback(async u=>{try{return n(null),await c.getParticipantById(u)}catch(j){const D=j instanceof Error?j:new Error("Error al obtener el participante");throw n(D),D}},[c]),I=y.useCallback(async()=>{try{return await c.getParticipantCountByTripId(o)}catch(u){const j=u instanceof Error?u:new Error("Error al obtener el conteo de participantes");throw n(j),j}},[o,c]);return y.useEffect(()=>{d()},[d]),{participants:t,isLoading:i,error:s,fetchParticipants:d,createParticipant:h,updateParticipant:w,deleteParticipant:g,getParticipantById:b,getParticipantCount:I,clearError:l,refetch:d}}const be={};function Kt(){const[o,t]=y.useState([]),[e,i]=y.useState(be),[r,s]=y.useState(!0),[n,c]=y.useState(null),{productService:l}=ce(),d=y.useMemo(()=>{let p=[...o];if(e.category&&(p=p.filter(v=>v.category===e.category)),e.type&&(p=p.filter(v=>v.type===e.type)),e.searchTerm&&e.searchTerm.trim()!==""){const v=e.searchTerm.toLowerCase().trim();p=p.filter(T=>T.name.toLowerCase().includes(v)||T.notes&&T.notes.toLowerCase().includes(v))}return p},[o,e]),h=y.useCallback(()=>{c(null)},[]),w=y.useCallback(async()=>{try{s(!0),c(null);const p=await l.getAllProducts();t(p)}catch(p){const v=p instanceof Error?p:new Error("Error al cargar los productos");c(v)}finally{s(!1)}},[l]),g=y.useCallback(async p=>{try{s(!0),c(null);const v=await l.createProduct(p);return t(T=>[...T,v]),v}catch(v){const T=v instanceof Error?v:new Error("Error al crear el producto");throw c(T),T}finally{s(!1)}},[l]),b=y.useCallback(async(p,v)=>{try{s(!0),c(null);const T=await l.updateProduct(p,v);return t(x=>x.map(M=>M.id===p?T:M)),T}catch(T){const x=T instanceof Error?T:new Error("Error al actualizar el producto");throw c(x),x}finally{s(!1)}},[l]),I=y.useCallback(async p=>{try{s(!0),c(null),await l.deleteProduct(p),t(v=>v.filter(T=>T.id!==p))}catch(v){const T=v instanceof Error?v:new Error("Error al eliminar el producto");throw c(T),T}finally{s(!1)}},[l]),u=y.useCallback(async p=>{try{return c(null),await l.getProductById(p)}catch(v){const T=v instanceof Error?v:new Error("Error al obtener el producto");throw c(T),T}},[l]),j=y.useCallback(p=>{i(p)},[]),D=y.useCallback(()=>{i(be)},[]),L=y.useCallback(p=>{i(v=>({...v,category:p,type:p!==v.category?void 0:v.type}))},[]),$=y.useCallback(p=>{i(v=>({...v,type:p}))},[]),A=y.useCallback(p=>{i(v=>({...v,searchTerm:p}))},[]);return y.useEffect(()=>{w()},[w]),{products:o,filteredProducts:d,filters:e,isLoading:r,error:n,fetchProducts:w,createProduct:g,updateProduct:b,deleteProduct:I,getProductById:u,setFilters:j,clearFilters:D,filterByCategory:L,filterByType:$,searchByName:A,clearError:h,refetch:w}}const Ss="_page_946bz_2",$s="_hero_946bz_8",Ms="_heroContent_946bz_17",Os="_heroTitle_946bz_22",qs="_heroSubtitle_946bz_29",Fs="_heroActions_946bz_36",Ws="_heroImage_946bz_41",zs="_section_946bz_53",Vs="_sectionHeader_946bz_57",Qs="_sectionTitle_946bz_64",Us="_sectionLink_946bz_71",Hs="_statsGrid_946bz_84",Gs="_statCard_946bz_90",Xs="_statContent_946bz_94",Ys="_statIcon_946bz_100",Js="_statInfo_946bz_110",Ks="_statValue_946bz_116",Zs="_statLabel_946bz_123",tn="_tripGrid_946bz_129",en="_tripLink_946bz_135",an="_tripCard_946bz_144",rn="_tripInfo_946bz_148",sn="_tripDate_946bz_154",nn="_tripParticipants_946bz_155",on="_featureGrid_946bz_169",cn="_featureCard_946bz_175",ln="_featureIcon_946bz_189",dn="_featureTitle_946bz_201",pn="_featureDescription_946bz_208",un="_error_946bz_216",N={page:Ss,hero:$s,heroContent:Ms,heroTitle:Os,heroSubtitle:qs,heroActions:Fs,heroImage:Ws,section:zs,sectionHeader:Vs,sectionTitle:Qs,sectionLink:Us,statsGrid:Hs,statCard:Gs,statContent:Xs,statIcon:Ys,statInfo:Js,statValue:Ks,statLabel:Zs,tripGrid:tn,tripLink:en,tripCard:an,tripInfo:rn,tripDate:sn,tripParticipants:nn,featureGrid:on,featureCard:cn,featureIcon:ln,featureTitle:dn,featureDescription:pn,error:un},hn=()=>{const{trips:o,isLoading:t,error:e}=de(),i=o.slice(0,3),r=y.useMemo(()=>{const n=new Date,c=o.filter(h=>new Date(h.startDate)>n).length,l=o.filter(h=>new Date(h.endDate)<n).length,d=o.reduce((h,w)=>h+w.participantCount,0);return{totalTrips:o.length,totalParticipants:d,upcomingTrips:c,pastTrips:l}},[o]),s=()=>t?a.jsx(Pt,{message:"Cargando viajes..."}):e?a.jsx("div",{className:N.error,children:a.jsx("p",{children:e})}):a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:N.hero,children:[a.jsxs("div",{className:N.heroContent,children:[a.jsx("h1",{className:N.heroTitle,children:"TripFood Manager"}),a.jsx("p",{className:N.heroSubtitle,children:"Organiza las compras de comida y bebida para tus viajes en grupo de manera facil y colaborativa"}),a.jsxs("div",{className:N.heroActions,children:[a.jsx(it,{to:"/trips",children:a.jsx(Q,{variant:"primary",size:"lg",children:"Ver mis viajes"})}),a.jsx(it,{to:"/trips/new",children:a.jsx(Q,{variant:"secondary",size:"lg",children:"Crear nuevo viaje"})})]})]}),a.jsx("div",{className:N.heroImage,"aria-hidden":"true",children:a.jsxs("svg",{viewBox:"0 0 200 200",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"100",cy:"100",r:"80",fill:"var(--color-primary-100)"}),a.jsx("path",{d:"M60 80h80v60a10 10 0 01-10 10H70a10 10 0 01-10-10V80z",fill:"var(--color-primary-500)"}),a.jsx("rect",{x:"70",y:"60",width:"60",height:"20",rx:"5",fill:"var(--color-primary-600)"}),a.jsx("circle",{cx:"85",cy:"110",r:"8",fill:"white"}),a.jsx("circle",{cx:"115",cy:"110",r:"8",fill:"white"}),a.jsx("rect",{x:"90",y:"125",width:"20",height:"5",rx:"2",fill:"white"})]})})]}),o.length>0&&a.jsxs("section",{className:N.section,children:[a.jsx("h2",{className:N.sectionTitle,children:"Estadisticas generales"}),a.jsxs("div",{className:N.statsGrid,children:[a.jsx(V,{className:N.statCard,children:a.jsxs("div",{className:N.statContent,children:[a.jsx("div",{className:N.statIcon,style:{background:"var(--color-primary-50)",color:"var(--color-primary-600)"},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}),a.jsxs("div",{className:N.statInfo,children:[a.jsx("span",{className:N.statValue,children:r.totalTrips}),a.jsx("span",{className:N.statLabel,children:"Viajes totales"})]})]})}),a.jsx(V,{className:N.statCard,children:a.jsxs("div",{className:N.statContent,children:[a.jsx("div",{className:N.statIcon,style:{background:"rgba(16, 185, 129, 0.1)",color:"var(--color-success)"},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]})}),a.jsxs("div",{className:N.statInfo,children:[a.jsx("span",{className:N.statValue,children:r.totalParticipants}),a.jsx("span",{className:N.statLabel,children:"Participantes totales"})]})]})}),a.jsx(V,{className:N.statCard,children:a.jsxs("div",{className:N.statContent,children:[a.jsx("div",{className:N.statIcon,style:{background:"rgba(59, 130, 246, 0.1)",color:"#2563eb"},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),a.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),a.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}),a.jsxs("div",{className:N.statInfo,children:[a.jsx("span",{className:N.statValue,children:r.upcomingTrips}),a.jsx("span",{className:N.statLabel,children:"Viajes proximos"})]})]})}),a.jsx(V,{className:N.statCard,children:a.jsxs("div",{className:N.statContent,children:[a.jsx("div",{className:N.statIcon,style:{background:"var(--color-gray-100)",color:"var(--color-gray-600)"},children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})})}),a.jsxs("div",{className:N.statInfo,children:[a.jsx("span",{className:N.statValue,children:r.pastTrips}),a.jsx("span",{className:N.statLabel,children:"Viajes completados"})]})]})})]})]}),a.jsxs("section",{className:N.section,children:[a.jsxs("div",{className:N.sectionHeader,children:[a.jsx("h2",{className:N.sectionTitle,children:"Viajes recientes"}),a.jsx(it,{to:"/trips",className:N.sectionLink,children:"Ver todos"})]}),i.length===0?a.jsx(Dt,{title:"No tienes viajes todavia",description:"Crea tu primer viaje para empezar a organizar las compras del grupo",action:a.jsx(it,{to:"/trips/new",children:a.jsx(Q,{variant:"primary",children:"Crear viaje"})})}):a.jsx("div",{className:N.tripGrid,children:i.map(n=>a.jsx(it,{to:`/trips/${n.id}`,className:N.tripLink,children:a.jsx(V,{title:n.name,subtitle:n.location,interactive:!0,className:N.tripCard,children:a.jsxs("div",{className:N.tripInfo,children:[a.jsxs("div",{className:N.tripDate,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),a.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),a.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),a.jsxs("span",{children:[new Date(n.startDate).toLocaleDateString("es-ES",{day:"numeric",month:"short"})," - ",new Date(n.endDate).toLocaleDateString("es-ES",{day:"numeric",month:"short"})]})]}),a.jsxs("div",{className:N.tripParticipants,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]}),a.jsxs("span",{children:[n.participantCount," participantes"]})]})]})})},n.id))})]}),a.jsxs("section",{className:N.section,children:[a.jsx("h2",{className:N.sectionTitle,children:"Funcionalidades"}),a.jsxs("div",{className:N.featureGrid,children:[a.jsxs("div",{className:N.featureCard,children:[a.jsx("div",{className:N.featureIcon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]})}),a.jsx("h3",{className:N.featureTitle,children:"Gestion de participantes"}),a.jsx("p",{className:N.featureDescription,children:"Anade y gestiona los participantes del viaje facilmente"})]}),a.jsxs("div",{className:N.featureCard,children:[a.jsx("div",{className:N.featureIcon,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"})})}),a.jsx("h3",{className:N.featureTitle,children:"Catalogo de productos"}),a.jsx("p",{className:N.featureDescription,children:"Crea una lista completa de productos necesarios para el viaje"})]}),a.jsxs("div",{className:N.featureCard,children:[a.jsx("div",{className:N.featureIcon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 11l3 3L22 4"}),a.jsx("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"})]})}),a.jsx("h3",{className:N.featureTitle,children:"Matriz de disponibilidad"}),a.jsx("p",{className:N.featureDescription,children:"Cada participante indica que productos puede conseguir"})]}),a.jsxs("div",{className:N.featureCard,children:[a.jsx("div",{className:N.featureIcon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"9",cy:"21",r:"1"}),a.jsx("circle",{cx:"20",cy:"21",r:"1"}),a.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"})]})}),a.jsx("h3",{className:N.featureTitle,children:"Lista de compras"}),a.jsx("p",{className:N.featureDescription,children:"Genera automaticamente la lista de compras optimizada"})]})]})]})]});return a.jsx(X,{showNav:!0,children:a.jsx("div",{className:N.page,children:s()})})},mn="_page_h80zn_2",yn="_header_h80zn_8",fn="_title_h80zn_15",vn="_tripGrid_h80zn_23",gn="_tripCard_h80zn_29",xn="_tripContent_h80zn_33",wn="_tripDescription_h80zn_39",_n="_tripMeta_h80zn_50",bn="_tripDate_h80zn_56",jn="_tripParticipants_h80zn_57",In="_viewLink_h80zn_71",Nn="_deleteButton_h80zn_81",Cn="_form_h80zn_106",Pn="_dateRow_h80zn_112",Dn="_formActions_h80zn_118",J={page:mn,header:yn,title:fn,tripGrid:vn,tripCard:gn,tripContent:xn,tripDescription:wn,tripMeta:_n,tripDate:bn,tripParticipants:jn,viewLink:In,deleteButton:Nn,form:Cn,dateRow:Pn,formActions:Dn},An=()=>{const o=Qe(),{trips:t,isLoading:e,error:i,createTrip:r,deleteTrip:s,clearError:n}=de(),c=jt(),l=jt(),[d,h]=y.useState({name:"",description:"",startDate:"",endDate:"",location:""}),[w,g]=y.useState({}),[b,I]=y.useState(!1),[u,j]=y.useState(null),D=()=>{h({name:"",description:"",startDate:"",endDate:"",location:""}),g({})},L=()=>{const x={};return d.name.trim()||(x.name="El nombre es obligatorio"),d.startDate||(x.startDate="La fecha de inicio es obligatoria"),d.endDate||(x.endDate="La fecha de fin es obligatoria"),d.startDate&&d.endDate&&d.startDate>d.endDate&&(x.endDate="La fecha de fin debe ser posterior a la de inicio"),g(x),Object.keys(x).length===0},$=async x=>{if(x.preventDefault(),!!L()){I(!0);try{const M=await r(d);c.close(),D(),o(`/trips/${M.id}`)}catch{}finally{I(!1)}}},A=x=>{j(x),l.open()},p=async()=>{if(u)try{await s(u),l.close(),j(null)}catch{}},v=()=>{D(),c.open()},T=()=>e&&t.length===0?a.jsx(Pt,{message:"Cargando viajes..."}):i?a.jsx(Lt,{title:"Error al cargar viajes",message:i,onRetry:n}):t.length===0?a.jsx(Dt,{title:"No tienes viajes todavia",description:"Crea tu primer viaje para empezar a organizar las compras del grupo",action:a.jsx(Q,{variant:"primary",onClick:v,children:"Crear viaje"})}):a.jsx("div",{className:J.tripGrid,children:t.map(x=>a.jsx(V,{title:x.name,subtitle:x.location,className:J.tripCard,headerActions:a.jsx("button",{type:"button",className:J.deleteButton,onClick:M=>{M.stopPropagation(),A(x.id)},"aria-label":`Eliminar ${x.name}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})}),children:a.jsxs("div",{className:J.tripContent,children:[x.description&&a.jsx("p",{className:J.tripDescription,children:x.description}),a.jsxs("div",{className:J.tripMeta,children:[a.jsxs("div",{className:J.tripDate,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),a.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),a.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),a.jsxs("span",{children:[new Date(x.startDate).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})," - ",new Date(x.endDate).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})]})]}),a.jsxs("div",{className:J.tripParticipants,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]}),a.jsxs("span",{children:[x.participantCount," participantes"]})]})]}),a.jsx(it,{to:`/trips/${x.id}`,className:J.viewLink,children:a.jsx(Q,{variant:"primary",fullWidth:!0,children:"Ver viaje"})})]})},x.id))});return a.jsx(X,{showNav:!0,children:a.jsxs("div",{className:J.page,children:[a.jsxs("div",{className:J.header,children:[a.jsx("h1",{className:J.title,children:"Mis Viajes"}),a.jsxs(Q,{variant:"primary",onClick:v,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Nuevo viaje"]})]}),T(),a.jsx(Et,{isOpen:c.isOpen,onClose:c.close,title:"Crear nuevo viaje",size:"md",children:a.jsxs("form",{onSubmit:$,className:J.form,children:[a.jsx(rt,{label:"Nombre del viaje",placeholder:"Ej: Viaje a la playa",value:d.name,onChange:x=>h({...d,name:x.target.value}),error:w.name,required:!0,fullWidth:!0}),a.jsx(rt,{label:"Descripcion",placeholder:"Describe brevemente el viaje",value:d.description,onChange:x=>h({...d,description:x.target.value}),fullWidth:!0}),a.jsx(rt,{label:"Ubicacion",placeholder:"Ej: Costa Brava",value:d.location,onChange:x=>h({...d,location:x.target.value}),fullWidth:!0}),a.jsxs("div",{className:J.dateRow,children:[a.jsx(rt,{type:"date",label:"Fecha de inicio",value:d.startDate,onChange:x=>h({...d,startDate:x.target.value}),error:w.startDate,required:!0,fullWidth:!0}),a.jsx(rt,{type:"date",label:"Fecha de fin",value:d.endDate,onChange:x=>h({...d,endDate:x.target.value}),error:w.endDate,required:!0,fullWidth:!0})]}),a.jsxs("div",{className:J.formActions,children:[a.jsx(Q,{type:"button",variant:"secondary",onClick:c.close,disabled:b,children:"Cancelar"}),a.jsx(Q,{type:"submit",variant:"primary",isLoading:b,children:"Crear viaje"})]})]})}),a.jsx(le,{isOpen:l.isOpen,onClose:l.close,onConfirm:p,title:"Eliminar viaje",message:"Estas seguro de que quieres eliminar este viaje? Esta accion no se puede deshacer y se eliminaran todos los datos asociados.",confirmText:"Eliminar",variant:"danger"})]})})},Rn="_page_5lpmb_2",Tn="_header_5lpmb_9",En="_headerContent_5lpmb_16",Bn="_title_5lpmb_20",Ln="_description_5lpmb_27",kn="_meta_5lpmb_34",Sn="_metaItem_5lpmb_40",$n="_statsGrid_5lpmb_54",Mn="_statCard_5lpmb_60",On="_statContent_5lpmb_64",qn="_statIcon_5lpmb_70",Fn="_statInfo_5lpmb_80",Wn="_statValue_5lpmb_86",zn="_statLabel_5lpmb_93",Vn="_progressCard_5lpmb_99",Qn="_progressContent_5lpmb_103",Un="_progressBar_5lpmb_109",Hn="_progressFill_5lpmb_116",Gn="_progressInfo_5lpmb_123",Xn="_progressPercentage_5lpmb_131",Yn="_actionsGrid_5lpmb_137",Jn="_actionLink_5lpmb_143",Kn="_actionCard_5lpmb_152",Zn="_actionContent_5lpmb_156",to="_actionIcon_5lpmb_162",eo="_actionText_5lpmb_174",ao="_actionArrow_5lpmb_191",C={page:Rn,header:Tn,headerContent:En,title:Bn,description:Ln,meta:kn,metaItem:Sn,statsGrid:$n,statCard:Mn,statContent:On,statIcon:qn,statInfo:Fn,statValue:Wn,statLabel:zn,progressCard:Vn,progressContent:Qn,progressBar:Un,progressFill:Hn,progressInfo:Gn,progressPercentage:Xn,actionsGrid:Yn,actionLink:Jn,actionCard:Kn,actionContent:Zn,actionIcon:to,actionText:eo,actionArrow:ao},io=()=>{const{tripId:o}=Bt(),{trips:t,isLoading:e,error:i}=de(),{participants:r,isLoading:s}=Jt(o||""),{products:n,isLoading:c}=Kt(),l=t.find(u=>u.id===o),d=e||s||c,h=r.filter(u=>u.isActive).length,w=n.filter(u=>u.isPurchased).length,g=n.length-w,b=n.reduce((u,j)=>u+(j.estimatedPrice??0)*j.quantity,0),I=n.length>0?Math.round(w/n.length*100):0;return d?a.jsx(X,{showSidebar:!0,tripName:"Cargando...",children:a.jsx(Pt,{message:"Cargando viaje..."})}):i?a.jsx(X,{showSidebar:!0,children:a.jsx(Lt,{title:"Error al cargar el viaje",message:i})}):l?a.jsx(X,{showSidebar:!0,tripName:l.name,children:a.jsxs("div",{className:C.page,children:[a.jsx("div",{className:C.header,children:a.jsxs("div",{className:C.headerContent,children:[a.jsx("h1",{className:C.title,children:l.name}),l.description&&a.jsx("p",{className:C.description,children:l.description}),a.jsxs("div",{className:C.meta,children:[a.jsxs("span",{className:C.metaItem,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),a.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),a.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),new Date(l.startDate).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"})," - ",new Date(l.endDate).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"})]}),l.location&&a.jsxs("span",{className:C.metaItem,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"}),a.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),l.location]})]})]})}),a.jsxs("div",{className:C.statsGrid,children:[a.jsx(V,{className:C.statCard,children:a.jsxs("div",{className:C.statContent,children:[a.jsx("div",{className:C.statIcon,style:{background:"var(--color-primary-50)",color:"var(--color-primary-600)"},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]})}),a.jsxs("div",{className:C.statInfo,children:[a.jsx("span",{className:C.statValue,children:h}),a.jsx("span",{className:C.statLabel,children:"Participantes activos"})]})]})}),a.jsx(V,{className:C.statCard,children:a.jsxs("div",{className:C.statContent,children:[a.jsx("div",{className:C.statIcon,style:{background:"rgba(16, 185, 129, 0.1)",color:"var(--color-success)"},children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"})})}),a.jsxs("div",{className:C.statInfo,children:[a.jsx("span",{className:C.statValue,children:n.length}),a.jsx("span",{className:C.statLabel,children:"Productos totales"})]})]})}),a.jsx(V,{className:C.statCard,children:a.jsxs("div",{className:C.statContent,children:[a.jsx("div",{className:C.statIcon,style:{background:"rgba(245, 158, 11, 0.1)",color:"var(--color-warning)"},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"9",cy:"21",r:"1"}),a.jsx("circle",{cx:"20",cy:"21",r:"1"}),a.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"})]})}),a.jsxs("div",{className:C.statInfo,children:[a.jsx("span",{className:C.statValue,children:g}),a.jsx("span",{className:C.statLabel,children:"Por comprar"})]})]})}),a.jsx(V,{className:C.statCard,children:a.jsxs("div",{className:C.statContent,children:[a.jsx("div",{className:C.statIcon,style:{background:"var(--color-gray-100)",color:"var(--color-gray-600)"},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),a.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"})]})}),a.jsxs("div",{className:C.statInfo,children:[a.jsxs("span",{className:C.statValue,children:[b.toFixed(2),"EUR"]}),a.jsx("span",{className:C.statLabel,children:"Coste estimado"})]})]})})]}),a.jsx(V,{title:"Progreso de compras",className:C.progressCard,children:a.jsxs("div",{className:C.progressContent,children:[a.jsx("div",{className:C.progressBar,children:a.jsx("div",{className:C.progressFill,style:{width:`${I}%`}})}),a.jsxs("div",{className:C.progressInfo,children:[a.jsxs("span",{children:[w," de ",n.length," productos comprados"]}),a.jsxs("span",{className:C.progressPercentage,children:[I,"%"]})]})]})}),a.jsxs("div",{className:C.actionsGrid,children:[a.jsx(it,{to:`/trips/${o}/participants`,className:C.actionLink,children:a.jsx(V,{interactive:!0,className:C.actionCard,children:a.jsxs("div",{className:C.actionContent,children:[a.jsx("div",{className:C.actionIcon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]})}),a.jsxs("div",{className:C.actionText,children:[a.jsx("h3",{children:"Participantes"}),a.jsx("p",{children:"Gestiona los miembros del viaje"})]}),a.jsx("svg",{className:C.actionArrow,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})})}),a.jsx(it,{to:`/trips/${o}/products`,className:C.actionLink,children:a.jsx(V,{interactive:!0,className:C.actionCard,children:a.jsxs("div",{className:C.actionContent,children:[a.jsx("div",{className:C.actionIcon,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"})})}),a.jsxs("div",{className:C.actionText,children:[a.jsx("h3",{children:"Productos"}),a.jsx("p",{children:"Gestiona el catalogo de productos"})]}),a.jsx("svg",{className:C.actionArrow,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})})}),a.jsx(it,{to:`/trips/${o}/availability`,className:C.actionLink,children:a.jsx(V,{interactive:!0,className:C.actionCard,children:a.jsxs("div",{className:C.actionContent,children:[a.jsx("div",{className:C.actionIcon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 11l3 3L22 4"}),a.jsx("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"})]})}),a.jsxs("div",{className:C.actionText,children:[a.jsx("h3",{children:"Disponibilidad"}),a.jsx("p",{children:"Matriz de quien trae que"})]}),a.jsx("svg",{className:C.actionArrow,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})})}),a.jsx(it,{to:`/trips/${o}/shopping`,className:C.actionLink,children:a.jsx(V,{interactive:!0,className:C.actionCard,children:a.jsxs("div",{className:C.actionContent,children:[a.jsx("div",{className:C.actionIcon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"9",cy:"21",r:"1"}),a.jsx("circle",{cx:"20",cy:"21",r:"1"}),a.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"})]})}),a.jsxs("div",{className:C.actionText,children:[a.jsx("h3",{children:"Lista de compras"}),a.jsx("p",{children:"Ver y gestionar la lista final"})]}),a.jsx("svg",{className:C.actionArrow,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})})})]})]})}):a.jsx(X,{showSidebar:!0,children:a.jsx(Dt,{title:"Viaje no encontrado",description:"El viaje que buscas no existe o ha sido eliminado",action:a.jsx(it,{to:"/trips",children:a.jsx(Q,{variant:"primary",children:"Volver a viajes"})})})})},ro="_page_uhean_2",so="_header_uhean_9",no="_title_uhean_16",oo="_subtitle_uhean_23",co="_nameCell_uhean_30",lo="_avatar_uhean_36",po="_statusBadge_uhean_50",uo="_active_uhean_62",ho="_inactive_uhean_71",mo="_actions_uhean_81",yo="_actionButton_uhean_88",fo="_danger_uhean_107",vo="_form_uhean_118",go="_formActions_uhean_124",K={page:ro,header:so,title:no,subtitle:oo,nameCell:co,avatar:lo,statusBadge:po,active:uo,inactive:ho,actions:mo,actionButton:yo,danger:fo,form:vo,formActions:go},xo=()=>{const{tripId:o}=Bt(),{participants:t,isLoading:e,error:i,createParticipant:r,updateParticipant:s,deleteParticipant:n,toggleActive:c,clearError:l}=Jt(o||""),d=jt(),h=jt(),w=jt(),[g,b]=y.useState({name:"",email:"",phone:""}),[I,u]=y.useState({}),[j,D]=y.useState(!1),[L,$]=y.useState(null),[A,p]=y.useState(null),v=()=>{b({name:"",email:"",phone:""}),u({}),$(null)},T=()=>{const B={};return g.name.trim()||(B.name="El nombre es obligatorio"),g.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.email)&&(B.email="El email no es valido"),u(B),Object.keys(B).length===0},x=async B=>{if(B.preventDefault(),!!T()){D(!0);try{await r(g),d.close(),v()}catch{}finally{D(!1)}}},M=async B=>{if(B.preventDefault(),!(!T()||!L)){D(!0);try{await s({id:L.id,...g}),h.close(),v()}catch{}finally{D(!1)}}},ct=B=>{$(B),b({name:B.name,email:B.email||"",phone:B.phone||""}),h.open()},st=B=>{p(B),w.open()},pt=async()=>{if(A)try{await n(A.id),w.close(),p(null)}catch{}},Ft=()=>{v(),d.open()},Zt=[{key:"name",header:"Nombre",render:B=>a.jsxs("div",{className:K.nameCell,children:[a.jsx("div",{className:K.avatar,children:B.name.charAt(0).toUpperCase()}),a.jsx("span",{children:B.name})]})},{key:"email",header:"Email",render:B=>B.email||"-"},{key:"phone",header:"Telefono",render:B=>B.phone||"-"},{key:"status",header:"Estado",render:B=>a.jsx("button",{type:"button",className:`${K.statusBadge} ${B.isActive?K.active:K.inactive}`,onClick:()=>c(B.id),"aria-label":`Cambiar estado de ${B.name}`,children:B.isActive?"Activo":"Inactivo"})},{key:"actions",header:"Acciones",align:"right",render:B=>a.jsxs("div",{className:K.actions,children:[a.jsx("button",{type:"button",className:K.actionButton,onClick:()=>ct(B),"aria-label":`Editar ${B.name}`,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{type:"button",className:`${K.actionButton} ${K.danger}`,onClick:()=>st(B),"aria-label":`Eliminar ${B.name}`,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})}],te=()=>e&&t.length===0?a.jsx(Pt,{message:"Cargando participantes..."}):i?a.jsx(Lt,{title:"Error al cargar participantes",message:i,onRetry:l}):t.length===0?a.jsx(Dt,{title:"No hay participantes",description:"Anade participantes al viaje para empezar a organizar las compras",icon:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"})]}),action:a.jsx(Q,{variant:"primary",onClick:Ft,children:"Anadir participante"})}):a.jsx(Le,{data:t,columns:Zt,getRowKey:B=>B.id}),kt=(B,At=!1)=>a.jsxs("form",{onSubmit:B,className:K.form,children:[a.jsx(rt,{label:"Nombre",placeholder:"Nombre del participante",value:g.name,onChange:xt=>b({...g,name:xt.target.value}),error:I.name,required:!0,fullWidth:!0}),a.jsx(rt,{type:"email",label:"Email",placeholder:"email@ejemplo.com",value:g.email,onChange:xt=>b({...g,email:xt.target.value}),error:I.email,fullWidth:!0}),a.jsx(rt,{type:"tel",label:"Telefono",placeholder:"+34 600 000 000",value:g.phone,onChange:xt=>b({...g,phone:xt.target.value}),fullWidth:!0}),a.jsxs("div",{className:K.formActions,children:[a.jsx(Q,{type:"button",variant:"secondary",onClick:()=>{(At?h:d).close(),v()},disabled:j,children:"Cancelar"}),a.jsx(Q,{type:"submit",variant:"primary",isLoading:j,children:At?"Guardar cambios":"Anadir"})]})]});return a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsxs("div",{className:K.page,children:[a.jsxs("div",{className:K.header,children:[a.jsxs("div",{children:[a.jsx("h1",{className:K.title,children:"Participantes"}),a.jsxs("p",{className:K.subtitle,children:[t.length," participantes en total"]})]}),a.jsxs(Q,{variant:"primary",onClick:Ft,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Anadir participante"]})]}),te(),a.jsx(Et,{isOpen:d.isOpen,onClose:()=>{d.close(),v()},title:"Anadir participante",size:"sm",children:kt(x)}),a.jsx(Et,{isOpen:h.isOpen,onClose:()=>{h.close(),v()},title:"Editar participante",size:"sm",children:kt(M,!0)}),a.jsx(le,{isOpen:w.isOpen,onClose:()=>{w.close(),p(null)},onConfirm:pt,title:"Eliminar participante",message:`Estas seguro de que quieres eliminar a "${A==null?void 0:A.name}"? Esta accion no se puede deshacer.`,confirmText:"Eliminar",variant:"danger"})]})})},wo="_page_xj3za_2",_o="_header_xj3za_9",bo="_title_xj3za_16",jo="_subtitle_xj3za_23",Io="_filters_xj3za_30",No="_productCell_xj3za_36",Co="_productName_xj3za_42",Po="_productNotes_xj3za_47",Do="_categoryBadge_xj3za_53",Ao="_bebida_xj3za_62",Ro="_comida_xj3za_67",To="_snack_xj3za_72",Eo="_otro_xj3za_77",Bo="_statusBadge_xj3za_83",Lo="_purchased_xj3za_95",ko="_pending_xj3za_104",So="_actions_xj3za_114",$o="_actionButton_xj3za_121",Mo="_danger_xj3za_140",Oo="_form_xj3za_151",qo="_row_xj3za_157",Fo="_formActions_xj3za_163",z={page:wo,header:_o,title:bo,subtitle:jo,filters:Io,productCell:No,productName:Co,productNotes:Po,categoryBadge:Do,bebida:Ao,comida:Ro,snack:To,otro:Eo,statusBadge:Bo,purchased:Lo,pending:ko,actions:So,actionButton:$o,danger:Mo,form:Oo,row:qo,formActions:Fo},je=[{value:"bebida",label:"Bebida"},{value:"comida",label:"Comida"},{value:"snack",label:"Snack"},{value:"otro",label:"Otro"}],Wo={bebida:"Bebida",comida:"Comida",snack:"Snack",otro:"Otro"},zo=()=>{const{tripId:o}=Bt(),{products:t,isLoading:e,error:i,createProduct:r,updateProduct:s,deleteProduct:n,togglePurchased:c,clearError:l}=Kt(),d=jt(),h=jt(),w=jt(),[g,b]=y.useState({name:"",category:"comida",unit:"",quantity:1,estimatedPrice:void 0,notes:""}),[I,u]=y.useState({}),[j,D]=y.useState(!1),[L,$]=y.useState(null),[A,p]=y.useState(null),[v,T]=y.useState(""),x=v?t.filter(P=>P.category===v):t,M=()=>{b({name:"",category:"comida",unit:"",quantity:1,estimatedPrice:void 0,notes:""}),u({}),$(null)},ct=()=>{const P={};return g.name.trim()||(P.name="El nombre es obligatorio"),g.unit.trim()||(P.unit="La unidad es obligatoria"),g.quantity<1&&(P.quantity="La cantidad debe ser al menos 1"),u(P),Object.keys(P).length===0},st=async P=>{if(P.preventDefault(),!!ct()){D(!0);try{await r(g),d.close(),M()}catch{}finally{D(!1)}}},pt=async P=>{if(P.preventDefault(),!(!ct()||!L)){D(!0);try{await s({id:L.id,...g}),h.close(),M()}catch{}finally{D(!1)}}},Ft=P=>{$(P),b({name:P.name,category:P.category,unit:P.unit,quantity:P.quantity,estimatedPrice:P.estimatedPrice,notes:P.notes||""}),h.open()},Zt=P=>{p(P),w.open()},te=async()=>{if(A)try{await n(A.id),w.close(),p(null)}catch{}},kt=()=>{M(),d.open()},B=[{key:"name",header:"Producto",render:P=>a.jsxs("div",{className:z.productCell,children:[a.jsx("span",{className:z.productName,children:P.name}),P.notes&&a.jsx("span",{className:z.productNotes,children:P.notes})]})},{key:"category",header:"Categoria",render:P=>a.jsx("span",{className:`${z.categoryBadge} ${z[P.category]}`,children:Wo[P.category]})},{key:"quantity",header:"Cantidad",align:"center",render:P=>a.jsxs("span",{children:[P.quantity," ",P.unit]})},{key:"price",header:"Precio Est.",align:"right",render:P=>P.estimatedPrice?`${(P.estimatedPrice*P.quantity).toFixed(2)} EUR`:"-"},{key:"status",header:"Estado",render:P=>a.jsx("button",{type:"button",className:`${z.statusBadge} ${P.isPurchased?z.purchased:z.pending}`,onClick:()=>c(P.id),"aria-label":`Marcar ${P.name} como ${P.isPurchased?"pendiente":"comprado"}`,children:P.isPurchased?"Comprado":"Pendiente"})},{key:"actions",header:"Acciones",align:"right",render:P=>a.jsxs("div",{className:z.actions,children:[a.jsx("button",{type:"button",className:z.actionButton,onClick:()=>Ft(P),"aria-label":`Editar ${P.name}`,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{type:"button",className:`${z.actionButton} ${z.danger}`,onClick:()=>Zt(P),"aria-label":`Eliminar ${P.name}`,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})}],At=()=>e&&t.length===0?a.jsx(Pt,{message:"Cargando productos..."}):i?a.jsx(Lt,{title:"Error al cargar productos",message:i,onRetry:l}):t.length===0?a.jsx(Dt,{title:"No hay productos",description:"Anade productos al catalogo para empezar a organizar las compras",icon:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"})}),action:a.jsx(Q,{variant:"primary",onClick:kt,children:"Anadir producto"})}):a.jsx(Le,{data:x,columns:B,getRowKey:P=>P.id,emptyMessage:"No hay productos en esta categoria"}),xt=(P,Nt=!1)=>{var pe;return a.jsxs("form",{onSubmit:P,className:z.form,children:[a.jsx(rt,{label:"Nombre del producto",placeholder:"Ej: Agua mineral",value:g.name,onChange:lt=>b({...g,name:lt.target.value}),error:I.name,required:!0,fullWidth:!0}),a.jsx(se,{label:"Categoria",options:je,value:g.category,onChange:lt=>b({...g,category:lt.target.value}),required:!0,fullWidth:!0}),a.jsxs("div",{className:z.row,children:[a.jsx(rt,{type:"number",label:"Cantidad",value:g.quantity.toString(),onChange:lt=>b({...g,quantity:parseInt(lt.target.value)||1}),error:I.quantity,required:!0,fullWidth:!0}),a.jsx(rt,{label:"Unidad",placeholder:"Ej: botella, paquete",value:g.unit,onChange:lt=>b({...g,unit:lt.target.value}),error:I.unit,required:!0,fullWidth:!0})]}),a.jsx(rt,{type:"number",label:"Precio estimado (por unidad)",placeholder:"0.00",value:((pe=g.estimatedPrice)==null?void 0:pe.toString())||"",onChange:lt=>b({...g,estimatedPrice:lt.target.value?parseFloat(lt.target.value):void 0}),rightAddon:"EUR",fullWidth:!0}),a.jsx(rt,{label:"Notas",placeholder:"Notas adicionales...",value:g.notes,onChange:lt=>b({...g,notes:lt.target.value}),fullWidth:!0}),a.jsxs("div",{className:z.formActions,children:[a.jsx(Q,{type:"button",variant:"secondary",onClick:()=>{(Nt?h:d).close(),M()},disabled:j,children:"Cancelar"}),a.jsx(Q,{type:"submit",variant:"primary",isLoading:j,children:Nt?"Guardar cambios":"Anadir"})]})]})},Se=t.length,$e=t.filter(P=>P.isPurchased).length,Me=t.reduce((P,Nt)=>P+(Nt.estimatedPrice??0)*Nt.quantity,0);return a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsxs("div",{className:z.page,children:[a.jsxs("div",{className:z.header,children:[a.jsxs("div",{children:[a.jsx("h1",{className:z.title,children:"Productos"}),a.jsxs("p",{className:z.subtitle,children:[$e," de ",Se," comprados - Total estimado: ",Me.toFixed(2)," EUR"]})]}),a.jsxs(Q,{variant:"primary",onClick:kt,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Anadir producto"]})]}),t.length>0&&a.jsx("div",{className:z.filters,children:a.jsx(se,{options:[{value:"",label:"Todas las categorias"},...je],value:v,onChange:P=>T(P.target.value),size:"sm"})}),At(),a.jsx(Et,{isOpen:d.isOpen,onClose:()=>{d.close(),M()},title:"Anadir producto",size:"md",children:xt(st)}),a.jsx(Et,{isOpen:h.isOpen,onClose:()=>{h.close(),M()},title:"Editar producto",size:"md",children:xt(pt,!0)}),a.jsx(le,{isOpen:w.isOpen,onClose:()=>{w.close(),p(null)},onConfirm:te,title:"Eliminar producto",message:`Estas seguro de que quieres eliminar "${A==null?void 0:A.name}"? Esta accion no se puede deshacer.`,confirmText:"Eliminar",variant:"danger"})]})})},Vo="_page_9p5ln_2",Qo="_header_9p5ln_9",Uo="_title_9p5ln_16",Ho="_subtitle_9p5ln_23",Go="_legend_9p5ln_30",Xo="_legendContent_9p5ln_34",Yo="_legendItem_9p5ln_40",Jo="_legendBox_9p5ln_48",Ko="_available_9p5ln_57",Zo="_unavailable_9p5ln_62",tc="_matrixWrapper_9p5ln_68",ec="_matrix_9p5ln_68",ac="_warningRow_9p5ln_101",ic="_cornerCell_9p5ln_106",rc="_participantHeader_9p5ln_114",sc="_participantInfo_9p5ln_119",nc="_avatar_9p5ln_126",oc="_participantName_9p5ln_139",cc="_participantCount_9p5ln_148",lc="_totalHeader_9p5ln_154",dc="_productCell_9p5ln_162",pc="_productName_9p5ln_168",uc="_productUnit_9p5ln_173",hc="_checkCell_9p5ln_179",mc="_checkButton_9p5ln_183",yc="_checked_9p5ln_206",fc="_totalCell_9p5ln_217",vc="_warning_9p5ln_101",gc="_summary_9p5ln_228",xc="_summaryGrid_9p5ln_232",wc="_summaryItem_9p5ln_238",_c="_summaryValue_9p5ln_245",bc="_summaryLabel_9p5ln_255",E={page:Vo,header:Qo,title:Uo,subtitle:Ho,legend:Go,legendContent:Xo,legendItem:Yo,legendBox:Jo,available:Ko,unavailable:Zo,matrixWrapper:tc,matrix:ec,warningRow:ac,cornerCell:ic,participantHeader:rc,participantInfo:sc,avatar:nc,participantName:oc,participantCount:cc,totalHeader:lc,productCell:dc,productName:pc,productUnit:uc,checkCell:hc,checkButton:mc,checked:yc,totalCell:fc,warning:vc,summary:gc,summaryGrid:xc,summaryItem:wc,summaryValue:_c,summaryLabel:bc},jc=()=>{const{tripId:o}=Bt(),{participants:t,isLoading:e,error:i}=Jt(o||""),{products:r,isLoading:s,error:n}=Kt(),[c,l]=y.useState({}),d=e||s,h=i||n;y.useEffect(()=>{const u={};t.forEach(j=>{u[j.id]={},r.forEach(D=>{u[j.id][D.id]=!1})}),l(u)},[t,r]);const w=(u,j)=>{l(D=>{var L;return{...D,[u]:{...D[u],[j]:!((L=D[u])!=null&&L[j])}}})},g=u=>Object.values(c).filter(j=>j[u]).length,b=u=>Object.values(c[u]||{}).filter(Boolean).length,I=t.filter(u=>u.isActive);return d?a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsx(Pt,{message:"Cargando matriz de disponibilidad..."})}):h?a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsx(Lt,{title:"Error al cargar datos",message:h})}):I.length===0||r.length===0?a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsxs("div",{className:E.page,children:[a.jsxs("div",{className:E.header,children:[a.jsx("h1",{className:E.title,children:"Disponibilidad"}),a.jsx("p",{className:E.subtitle,children:"Indica que productos puede traer cada participante"})]}),a.jsx(Dt,{title:I.length===0?"No hay participantes activos":"No hay productos",description:I.length===0?"Anade participantes activos al viaje para crear la matriz de disponibilidad":"Anade productos al catalogo para crear la matriz de disponibilidad",icon:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M9 11l3 3L22 4"}),a.jsx("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"})]})})]})}):a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsxs("div",{className:E.page,children:[a.jsx("div",{className:E.header,children:a.jsxs("div",{children:[a.jsx("h1",{className:E.title,children:"Disponibilidad"}),a.jsx("p",{className:E.subtitle,children:"Marca las casillas para indicar que productos puede traer cada participante"})]})}),a.jsx(V,{className:E.legend,children:a.jsxs("div",{className:E.legendContent,children:[a.jsxs("div",{className:E.legendItem,children:[a.jsx("div",{className:`${E.legendBox} ${E.available}`,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})}),a.jsx("span",{children:"Puede traer"})]}),a.jsxs("div",{className:E.legendItem,children:[a.jsx("div",{className:`${E.legendBox} ${E.unavailable}`}),a.jsx("span",{children:"No disponible"})]})]})}),a.jsx("div",{className:E.matrixWrapper,children:a.jsxs("table",{className:E.matrix,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:E.cornerCell,children:"Producto / Participante"}),I.map(u=>a.jsx("th",{className:E.participantHeader,children:a.jsxs("div",{className:E.participantInfo,children:[a.jsx("div",{className:E.avatar,children:u.name.charAt(0).toUpperCase()}),a.jsx("span",{className:E.participantName,children:u.name}),a.jsx("span",{className:E.participantCount,children:b(u.id)})]})},u.id)),a.jsx("th",{className:E.totalHeader,children:"Total"})]})}),a.jsx("tbody",{children:r.map(u=>{const j=g(u.id),D=j===0;return a.jsxs("tr",{className:D?E.warningRow:"",children:[a.jsxs("td",{className:E.productCell,children:[a.jsx("span",{className:E.productName,children:u.name}),a.jsxs("span",{className:E.productUnit,children:[u.quantity," ",u.unit]})]}),I.map(L=>{var A;const $=((A=c[L.id])==null?void 0:A[u.id])||!1;return a.jsx("td",{className:E.checkCell,children:a.jsx("button",{type:"button",className:`${E.checkButton} ${$?E.checked:""}`,onClick:()=>w(L.id,u.id),"aria-label":`${L.name} ${$?"puede":"no puede"} traer ${u.name}`,"aria-pressed":$,children:$&&a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})})},L.id)}),a.jsx("td",{className:`${E.totalCell} ${D?E.warning:""}`,children:j})]},u.id)})})]})}),a.jsx(V,{title:"Resumen",className:E.summary,children:a.jsxs("div",{className:E.summaryGrid,children:[a.jsxs("div",{className:E.summaryItem,children:[a.jsx("span",{className:E.summaryValue,children:r.length}),a.jsx("span",{className:E.summaryLabel,children:"Productos totales"})]}),a.jsxs("div",{className:E.summaryItem,children:[a.jsx("span",{className:E.summaryValue,children:I.length}),a.jsx("span",{className:E.summaryLabel,children:"Participantes activos"})]}),a.jsxs("div",{className:E.summaryItem,children:[a.jsx("span",{className:`${E.summaryValue} ${r.filter(u=>g(u.id)===0).length>0?E.warning:""}`,children:r.filter(u=>g(u.id)===0).length}),a.jsx("span",{className:E.summaryLabel,children:"Sin asignar"})]}),a.jsxs("div",{className:E.summaryItem,children:[a.jsx("span",{className:E.summaryValue,children:r.filter(u=>g(u.id)>0).length}),a.jsx("span",{className:E.summaryLabel,children:"Asignados"})]})]})})]})})},Ic="_page_1bjn3_2",Nc="_header_1bjn3_9",Cc="_title_1bjn3_16",Pc="_subtitle_1bjn3_23",Dc="_headerActions_1bjn3_29",Ac="_progressCard_1bjn3_35",Rc="_progressContent_1bjn3_39",Tc="_progressHeader_1bjn3_45",Ec="_progressTitle_1bjn3_51",Bc="_progressPercentage_1bjn3_56",Lc="_progressBar_1bjn3_62",kc="_progressFill_1bjn3_69",Sc="_progressStats_1bjn3_76",$c="_progressStat_1bjn3_76",Mc="_statValue_1bjn3_89",Oc="_statLabel_1bjn3_95",qc="_listsContainer_1bjn3_101",Fc="_categoryCard_1bjn3_107",Wc="_productList_1bjn3_112",zc="_productItem_1bjn3_118",Vc="_purchased_1bjn3_131",Qc="_productName_1bjn3_135",Uc="_checkbox_1bjn3_141",Hc="_productInfo_1bjn3_171",Gc="_productQuantity_1bjn3_187",Xc="_productPrice_1bjn3_192",Yc="_costCard_1bjn3_200",Jc="_costContent_1bjn3_204",Kc="_costSummary_1bjn3_210",Zc="_costItem_1bjn3_218",tl="_costLabel_1bjn3_226",el="_costValue_1bjn3_231",al="_highlight_1bjn3_237",il="_participantsList_1bjn3_242",rl="_participantCost_1bjn3_248",sl="_participantInfo_1bjn3_257",nl="_avatar_1bjn3_263",ol="_participantAmount_1bjn3_276",R={page:Ic,header:Nc,title:Cc,subtitle:Pc,headerActions:Dc,progressCard:Ac,progressContent:Rc,progressHeader:Tc,progressTitle:Ec,progressPercentage:Bc,progressBar:Lc,progressFill:kc,progressStats:Sc,progressStat:$c,statValue:Mc,statLabel:Oc,listsContainer:qc,categoryCard:Fc,productList:Wc,productItem:zc,purchased:Vc,productName:Qc,checkbox:Uc,productInfo:Hc,productQuantity:Gc,productPrice:Xc,costCard:Yc,costContent:Jc,costSummary:Kc,costItem:Zc,costLabel:tl,costValue:el,highlight:al,participantsList:il,participantCost:rl,participantInfo:sl,avatar:nl,participantAmount:ol};function cl(o,t){const e=["Producto","Categoria","Cantidad","Unidad","Precio Unitario","Precio Total","Estado","Notas"],i=o.map(s=>[s.name,t[s.category]||s.category,s.quantity.toString(),s.unit,s.estimatedPrice?s.estimatedPrice.toFixed(2):"",s.estimatedPrice?(s.estimatedPrice*s.quantity).toFixed(2):"",s.isPurchased?"Comprado":"Pendiente",s.notes||""]);return[e.join(";"),...i.map(s=>s.map(n=>`"${n.replace(/"/g,'""')}"`).join(";"))].join(`
`)}function ll(o,t,e){const i=new Blob(["\uFEFF"+o],{type:e}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}const dl=()=>{const{tripId:o}=Bt(),{participants:t,isLoading:e,error:i}=Jt(o||""),{products:r,isLoading:s,error:n,togglePurchased:c}=Kt(),l=e||s,d=i||n,h=r.reduce((p,v)=>{const T=v.category;return p[T]||(p[T]=[]),p[T].push(v),p},{}),w={bebida:"Bebidas",comida:"Comida",snack:"Snacks",otro:"Otros"},g=["bebida","comida","snack","otro"],b=y.useCallback(()=>{const p=cl(r,w),T=`lista-compras-${new Date().toISOString().split("T")[0]}.csv`;ll(p,T,"text/csv;charset=utf-8")},[r]),I=r.filter(p=>p.isPurchased).length,u=r.length-I,j=r.reduce((p,v)=>p+(v.estimatedPrice??0)*v.quantity,0),D=r.filter(p=>p.isPurchased).reduce((p,v)=>p+(v.estimatedPrice??0)*v.quantity,0),L=r.length>0?Math.round(I/r.length*100):0,$=t.filter(p=>p.isActive),A=$.length>0?j/$.length:0;return l?a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsx(Pt,{message:"Cargando lista de compras..."})}):d?a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsx(Lt,{title:"Error al cargar datos",message:d})}):r.length===0?a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsxs("div",{className:R.page,children:[a.jsx("div",{className:R.header,children:a.jsx("h1",{className:R.title,children:"Lista de Compras"})}),a.jsx(Dt,{title:"No hay productos",description:"Anade productos al catalogo para generar la lista de compras",icon:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"9",cy:"21",r:"1"}),a.jsx("circle",{cx:"20",cy:"21",r:"1"}),a.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"})]})})]})}):a.jsx(X,{showSidebar:!0,tripName:"Viaje",children:a.jsxs("div",{className:R.page,children:[a.jsxs("div",{className:R.header,children:[a.jsxs("div",{children:[a.jsx("h1",{className:R.title,children:"Lista de Compras"}),a.jsxs("p",{className:R.subtitle,children:[u," productos pendientes de ",r.length," totales"]})]}),a.jsx("div",{className:R.headerActions,children:a.jsxs(Q,{variant:"secondary",onClick:b,"aria-label":"Exportar lista de compras como CSV",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"})}),"Exportar CSV"]})})]}),a.jsx(V,{className:R.progressCard,children:a.jsxs("div",{className:R.progressContent,children:[a.jsxs("div",{className:R.progressHeader,children:[a.jsx("span",{className:R.progressTitle,children:"Progreso de compras"}),a.jsxs("span",{className:R.progressPercentage,children:[L,"%"]})]}),a.jsx("div",{className:R.progressBar,children:a.jsx("div",{className:R.progressFill,style:{width:`${L}%`}})}),a.jsxs("div",{className:R.progressStats,children:[a.jsxs("div",{className:R.progressStat,children:[a.jsx("span",{className:R.statValue,children:I}),a.jsx("span",{className:R.statLabel,children:"Comprados"})]}),a.jsxs("div",{className:R.progressStat,children:[a.jsx("span",{className:R.statValue,children:u}),a.jsx("span",{className:R.statLabel,children:"Pendientes"})]}),a.jsxs("div",{className:R.progressStat,children:[a.jsxs("span",{className:R.statValue,children:[D.toFixed(2)," EUR"]}),a.jsx("span",{className:R.statLabel,children:"Gastado"})]}),a.jsxs("div",{className:R.progressStat,children:[a.jsxs("span",{className:R.statValue,children:[j.toFixed(2)," EUR"]}),a.jsx("span",{className:R.statLabel,children:"Total Est."})]})]})]})}),a.jsx("div",{className:R.listsContainer,children:g.map(p=>{const v=h[p];if(!v||v.length===0)return null;const T=v.filter(x=>x.isPurchased).length;return a.jsx(V,{title:w[p],subtitle:`${T}/${v.length} comprados`,className:R.categoryCard,children:a.jsx("ul",{className:R.productList,children:v.map(x=>a.jsxs("li",{className:`${R.productItem} ${x.isPurchased?R.purchased:""}`,children:[a.jsx("button",{type:"button",className:R.checkbox,onClick:()=>c(x.id),"aria-label":`Marcar ${x.name} como ${x.isPurchased?"pendiente":"comprado"}`,"aria-pressed":x.isPurchased,children:x.isPurchased&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})}),a.jsxs("div",{className:R.productInfo,children:[a.jsx("span",{className:R.productName,children:x.name}),a.jsxs("span",{className:R.productQuantity,children:[x.quantity," ",x.unit]})]}),x.estimatedPrice&&a.jsxs("span",{className:R.productPrice,children:[(x.estimatedPrice*x.quantity).toFixed(2)," EUR"]})]},x.id))})},p)})}),a.jsx(V,{title:"Reparto de costes",className:R.costCard,children:a.jsxs("div",{className:R.costContent,children:[a.jsxs("div",{className:R.costSummary,children:[a.jsxs("div",{className:R.costItem,children:[a.jsx("span",{className:R.costLabel,children:"Coste total estimado"}),a.jsxs("span",{className:R.costValue,children:[j.toFixed(2)," EUR"]})]}),a.jsxs("div",{className:R.costItem,children:[a.jsx("span",{className:R.costLabel,children:"Participantes activos"}),a.jsx("span",{className:R.costValue,children:$.length})]}),a.jsxs("div",{className:R.costItem,children:[a.jsx("span",{className:R.costLabel,children:"Coste por persona"}),a.jsxs("span",{className:`${R.costValue} ${R.highlight}`,children:[A.toFixed(2)," EUR"]})]})]}),$.length>0&&a.jsx("div",{className:R.participantsList,children:$.map(p=>a.jsxs("div",{className:R.participantCost,children:[a.jsxs("div",{className:R.participantInfo,children:[a.jsx("div",{className:R.avatar,children:p.name.charAt(0).toUpperCase()}),a.jsx("span",{children:p.name})]}),a.jsxs("span",{className:R.participantAmount,children:[A.toFixed(2)," EUR"]})]},p.id))})]})})]})})};function pl(o,t){const e=o.filter(c=>c.isActive).length,i=t.filter(c=>c.isPurchased).length,r=t.length-i,s=t.reduce((c,l)=>c+(l.estimatedPrice??0)*l.quantity,0),n=t.length>0?Math.round(i/t.length*100):0;return{totalParticipants:o.length,activeParticipants:e,totalProducts:t.length,purchasedProducts:i,pendingProducts:r,estimatedTotal:s,completionPercentage:n}}const ul=y.createContext(null),hl=({children:o,tripId:t})=>{const[e,i]=y.useState(null),[r,s]=y.useState([]),[n,c]=y.useState([]),[l,d]=y.useState([]),[h,w]=y.useState(!1),[g,b]=y.useState(null),I=y.useMemo(()=>pl(r,n),[r,n]),u=y.useCallback(x=>{i(x)},[]),j=y.useCallback(x=>{s(x)},[]),D=y.useCallback(x=>{c(x)},[]),L=y.useCallback(x=>{d(x)},[]),$=y.useCallback((x,M)=>{d(ct=>{const st=ct.findIndex(pt=>pt.participantId===x&&pt.productId===M);if(st>=0){const pt=[...ct];return pt[st]={...pt[st],available:!pt[st].available},pt}else return[...ct,{participantId:x,productId:M,available:!0}]})},[]),A=y.useCallback(x=>{w(x)},[]),p=y.useCallback(x=>{b(x)},[]),v=y.useCallback(()=>{i(null),s([]),c([]),d([]),b(null)},[]);y.useEffect(()=>{if(t){w(!0);const x=setTimeout(()=>{w(!1)},500);return()=>clearTimeout(x)}else v()},[t,v]);const T=y.useMemo(()=>({trip:e,participants:r,products:n,availability:l,stats:I,isLoading:h,error:g,setTrip:u,setParticipants:j,setProducts:D,setAvailability:L,toggleAvailability:$,setLoading:A,setError:p,clearTrip:v}),[e,r,n,l,I,h,g,u,j,D,L,$,A,p,v]);return a.jsx(ul.Provider,{value:T,children:o})},re={HOME:"/",TRIPS:"/trips"},ml=()=>a.jsxs(Ie,{children:[a.jsx(ft,{index:!0,element:a.jsx(io,{})}),a.jsx(ft,{path:"participants",element:a.jsx(xo,{})}),a.jsx(ft,{path:"products",element:a.jsx(zo,{})}),a.jsx(ft,{path:"availability",element:a.jsx(jc,{})}),a.jsx(ft,{path:"shopping",element:a.jsx(dl,{})}),a.jsx(ft,{path:"*",element:a.jsx(Ne,{to:"",replace:!0})})]}),yl=()=>a.jsxs(Ie,{children:[a.jsx(ft,{path:re.HOME,element:a.jsx(hn,{})}),a.jsx(ft,{path:re.TRIPS,element:a.jsx(An,{})}),a.jsx(ft,{path:"/trips/:tripId/*",element:a.jsx(hl,{children:a.jsx(ml,{})})}),a.jsx(ft,{path:"*",element:a.jsx(Ne,{to:re.HOME,replace:!0})})]}),fl=()=>a.jsx(Ue,{basename:"/tripfood-manager",children:a.jsx(Oa,{children:a.jsx(yl,{})})}),ke=document.getElementById("root");if(!ke)throw new Error('Root element not found. Make sure there is a div with id="root" in your HTML.');Je.createRoot(ke).render(a.jsx(y.StrictMode,{children:a.jsx(fl,{})}));
//# sourceMappingURL=index-sdsTn5gb.js.map
